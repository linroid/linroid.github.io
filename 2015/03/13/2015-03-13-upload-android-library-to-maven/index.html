<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="linroid">



    <meta name="description" content="Be creative">


    <meta name="keywords" content="linroid">


<title>提交 library 项目到 Maven Central | Lin&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Lin&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/category">Categories</a>
                
                <a class="menu-item" href="/tag">Tags</a>
                
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Lin&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">
                    <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"/></svg>
                    <svg class="close-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE --><path fill="currentColor" d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"/></svg>
                </div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/category">Categories</a>
                
                <a class="menu-item" href="/tag">Tags</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">提交 library 项目到 Maven Central</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">linroid</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 13, 2015&nbsp;&nbsp;10:51:42</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Android%E5%BC%80%E5%8F%91/">Android开发</a>
                            
                                <a href="/categories/Android%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/">构建系统</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>  将 <a target="_blank" rel="noopener" href="http://github.com/linroid/FilterMenu">FilterMenu</a> 提交到 GitHub 后，在 README.md 的 Getting Started 里仅仅写上</p>
<blockquote>
<p>Download the source to use it as library project</p>
</blockquote>
<p>  这唯一使用途径，居然没有 gradle&#x2F;maven ?作为 Android Studio 的忠实用户，自己写的库怎么能只提供这么麻烦的方法！！！于是决定把它提交到 Maven Central 中。</p>
<span id="more"></span>

<p>虽然 AS 的 gradle 默认使用的是 jcenter 仓库，但我们只需要提交到 Maven Central 即可，jcenter 会自动同步。  </p>
<p>__如果还没有账号先去 Maven Central 注册: <a target="_blank" rel="noopener" href="https://issues.sonatype.org/secure/Signup!default.jspa">Sign up</a> __</p>
<p>并到 <a target="_blank" rel="noopener" href="https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&pid=10134">Create Issue</a> 提交工单等待管理员的回复，填 groupId 时，请使用顶级 groupId，比如我只需要填写 <code>com.linroid</code>，就可以发布到任何 <code>com.linroid.*</code> 下的groupId。</p>
<p>我是早上提交的，到晚上0:30的时候收到回复。<a target="_blank" rel="noopener" href="http://central.sonatype.org/articles/2014/Feb/27/why-the-wait/">Why the wait?</a></p>
<blockquote>
<p>Configuration has been prepared, now you can:<br>Deploy snapshot artifacts into repository <a target="_blank" rel="noopener" href="https://oss.sonatype.org/content/repositories/snapshots">https://oss.sonatype.org/content/repositories/snapshots</a><br>Deploy release artifacts into the staging repository <a target="_blank" rel="noopener" href="https://oss.sonatype.org/service/local/staging/deploy/maven2">https://oss.sonatype.org/service/local/staging/deploy/maven2</a><br>Promote staged artifacts into repository ‘Releases’<br>Download snapshot and release artifacts from group <a target="_blank" rel="noopener" href="https://oss.sonatype.org/content/groups/public">https://oss.sonatype.org/content/groups/public</a><br>Download snapshot, release and staged artifacts from staging group <a target="_blank" rel="noopener" href="https://oss.sonatype.org/content/groups/staging">https://oss.sonatype.org/content/groups/staging</a><br>please comment on this ticket when you promoted your first release, thanks</p>
</blockquote>
<p>然后通过下面的方法 Release，再次回复那个 issue，几分钟后又收到回复:</p>
<blockquote>
<p>Central sync is activated for com.linroid. After you successfully release, your component will be published to Central, typically within 10 minutes, though updates to search.maven.org can take up to two hours.</p>
</blockquote>
<h2 id="通过-gradle-mvn-push"><a href="#通过-gradle-mvn-push" class="headerlink" title="通过 gradle-mvn-push"></a>通过 gradle-mvn-push</h2><p> <a target="_blank" rel="noopener" href="https://chris.banes.me/">Chris Banes</a>大神很早前写了一个插件 <a target="_blank" rel="noopener" href="https://github.com/chrisbanes/gradle-mvn-push">gradle-mvn-push</a>(终于有机会用它了^﹏^)，让你通过一条gradle命令就可以自动构建好aar并提交到 Maven Central。下面介绍这个插件的使用方法。</p>
<ul>
<li><p>配置用于上传的__认证信息__<br>  配置文件默认在<code> $&#123;HOME&#125;/.gradle/gradle.properties</code>，如果没有则自己创建。</p>
 <figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NEXUS_USERNAME</span>=<span class="string">linroid</span></span><br><span class="line"><span class="attr">NEXUS_PASSWORD</span>=<span class="string">YOUR_MAVEN_CENTRAL_PASSWORD</span></span><br><span class="line"></span><br><span class="line"><span class="attr">signing.keyId</span>=<span class="string">YOUR_GPG_KEY_ID</span></span><br><span class="line"><span class="attr">signing.password</span>=<span class="string">YOUR_GPG_PASSWORD</span></span><br><span class="line"><span class="attr">signing.secretKeyRingFile</span>=<span class="string">$&#123;HOME&#125;/.gnupg/secring.gpg</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p> <code>NEXUS_USERNAME</code> 和 <code>NEXUS_PASSWORD</code> 是你注册的用户名和密码，下面的是用于 GPG 校验的配置信息，关于 GPG 的使用可以参见阮一峰的博文:<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG 入门教程</a></p>
<ul>
<li><p>配置__版本信息__<br>在你的module目录创建<code>gradle.properties</code>文件，添加配置:</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POM_NAME=Android FilterMenu Library</span><br><span class="line">POM_ARTIFACT_ID=library</span><br><span class="line">POM_PACKAGING=aar</span><br><span class="line">VERSION_NAME=0.1.1</span><br><span class="line">VERSION_CODE=1</span><br><span class="line">GROUP=com.linroid.filtermenu</span><br><span class="line"></span><br><span class="line">POM_DESCRIPTION=Android FilterMenu Library</span><br><span class="line">POM_URL=https://github.com/linroid/FilterMenu</span><br><span class="line">POM_SCM_URL=https://github.com/linroid/FilterMenu</span><br><span class="line">POM_SCM_CONNECTION=scm:https://github.com/linroid/FilterMenu.git</span><br><span class="line">POM_SCM_DEV_CONNECTION=scm:https://github.com/linroid/FilterMenu.git</span><br><span class="line">POM_LICENCE_NAME=The Apache Software License, Version 2.0</span><br><span class="line">POM_LICENCE_URL=http://www.apache.org/licenses/LICENSE-2.0.txt</span><br><span class="line">POM_LICENCE_DIST=repo</span><br><span class="line">POM_DEVELOPER_ID=linroid</span><br><span class="line">POM_DEVELOPER_NAME=linroid</span><br><span class="line">POM_DEVELOPER_URL=http://linroid.com</span><br></pre></td></tr></table></figure>
<p>  根据你的项目修改吧(‘・ω・’)</p>
</li>
<li><p><strong>添加gradle-mvn-push插件</strong><br>  在 library module 的<code>build.gradle</code>文件中添加</p>
 <figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">from:</span> <span class="string">&#x27;https://raw.github.com/chrisbanes/gradle-mvn-push/master/gradle-mvn-push.gradle</span></span><br></pre></td></tr></table></figure>
<p>  或者可以将 <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/chrisbanes/gradle-mvn-push/master/gradle-mvn-push.gradle">gradle-mvn-push.gradle</a> 文件下载下来，然后将上面的url该为本地路径。</p>
</li>
<li><p><strong>执行gradle task</strong><br>  输入下面的命令，就可以自动构建并上传啦</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gradle clean build uploadArchives</span><br></pre></td></tr></table></figure>
<p>  出现如下结果就说明上传成功了:）<br> <img src="/images/posts/maven-central-success.png" alt="执行成功"><br>  还没结束，此时你的库并没有发布.</p>
</li>
<li><p><strong>最后一步</strong>：close staging repositories<br>  登陆 <a target="_blank" rel="noopener" href="https://oss.sonatype.org/">Sonatype Nexus Professional</a> 点开左边 Build Promotion 的 Staging Repositories ，滚到最下面找到你最新上传的(可以点Content确保是你上传的)，选中之后点击上面的 <code>Close</code> 按钮 和 <code>Release</code> 按钮(多谢<a target="_blank" rel="noopener" href="http://weibo.com/drak11t">@drak11t</a>的提示)。</p>
</li>
</ul>
<p>  Ok 了，还需要等待一小段时间才能在 <a target="_blank" rel="noopener" href="http://search.maven.org/">http://search.maven.org</a> 搜索到你的包。</p>
<p>##链接</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://central.sonatype.org/pages/ossrh-guide.html">OSSRH Guide</a> 官方指南</li>
<li><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG 入门教程</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/chrisbanes/gradle-mvn-push">gradle-mvn-push</a> </li>
<li><a target="_blank" rel="noopener" href="https://oss.sonatype.org/">Sonatype Nexus Professional</a></li>
</ul>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>linroid</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://linroid.com/2015/03/13/2015-03-13-upload-android-library-to-maven/">http://linroid.com/2015/03/13/2015-03-13-upload-android-library-to-maven/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/Android/"># Android</a>
                    
                        <a href="/tags/Gradle/"># Gradle</a>
                    
                        <a href="/tags/Maven/"># Maven</a>
                    
                        <a href="/tags/%E5%BC%80%E6%BA%90%E5%BA%93/"># 开源库</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2015/05/22/2015-05-22-internship-interview/">找实习的那点事</a>
            
            
            <a class="next" rel="next" href="/2015/02/11/2015-02-11-sky31radio/">四季电台</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© linroid | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a> | <a href="http://beian.miit.gov.cn", target="_blank">粤ICP备17156215号</a></span>
    </div>
</footer>

    </div>
</body>

</html>