<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>linroid</title>
  <icon>https://www.gravatar.com/avatar/cdc3b5746102b1b6b90917847f93724a</icon>
  <subtitle>ä¸ºå°è€Œç¾çš„åº”ç”¨å¥‹æ–—!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://linroid.com/"/>
  <updated>2019-12-21T15:53:13.852Z</updated>
  <id>http://linroid.com/</id>
  
  <author>
    <name>linroid</name>
    <email>linroid@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Activity çš„ onStop å±…ç„¶éœ€è¦ 10s æ‰ä¼šè¢«æ‰§è¡Œï¼Ÿ</title>
    <link href="http://linroid.com/2018/08/10/onStop-executed-too-slowly/"/>
    <id>http://linroid.com/2018/08/10/onStop-executed-too-slowly/</id>
    <published>2018-08-10T02:15:27.000Z</published>
    <updated>2019-12-21T15:53:13.852Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºæˆ‘ä»¬çš„åº”ç”¨ä¾èµ– Activity çš„ onStop æ¥åœæ­¢æ’­æ”¾å™¨ï¼Œè¿‘æœŸå‘ç°é€€å‡ºç›´æ’­é—´åï¼Œå£°éŸ³å±…ç„¶æ®‹ç•™10s å·¦å³ï¼Œé€šè¿‡æ—¥å¿—å‘ç° Activity çš„ onStop åœ¨é€€å‡ºç•Œé¢åéœ€è¦10så·¦å³æ‰ä¼šè¢«æ‰§è¡Œï¼Œè¯¥å¦‚ä½•å®šä½è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ<br><a id="more"></a><br>Activity çš„ onStop æ˜¯æ”¾åˆ° <code>IdleHandler</code> æ‰§è¡Œçš„ï¼Œæ‰€ä»¥é€€å‡ºç•Œé¢å onStop ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯ç­‰åˆ°ä¸»çº¿ç¨‹ä¸­å½“å‰æ²¡æœ‰æ¶ˆæ¯è¦æ‰§è¡Œçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼Œå…·ä½“å¯è§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« åˆ†æï¼š<a href="https://linroid.com/2017/05/24/Pit-of-Activity-destory/">Activity é”€æ¯çš„å»¶è¿Ÿ</a>ã€‚ä½†å¿…ç° 10s å·¦å³æ‰è¢«æ‰§è¡Œè‚¯å®šæ˜¯å¼‚å¸¸çš„ï¼Œå¯èƒ½æœ‰æ¶ˆæ¯å¯¼è‡´ä¸»çº¿ç¨‹ä¸€ç›´æ²¡æœ‰ å¤„ç† IdleHandlerï¼Œä¸ºéªŒè¯è¿™ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨ onPause çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª IdleHandler åˆ°ä¸»çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause();</span><br><span class="line">    Looper.myQueue().addIdleHandler(<span class="keyword">new</span> MessageQueue.IdleHandler() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">queueIdle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Log.i(TAG, <span class="string">"queueIdle after onPause"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæœç„¶æ˜¯åœ¨ onStop ä¹‹åæ‰ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ç¡®è®¤æ˜¯ç”±äºä¸»çº¿ç¨‹ä¸€ç›´æœ‰æ²¡æœ‰æ‰§è¡Œ IdleHandler å¯¼è‡´çš„ï¼Œåˆæ­¥æ€€ç–‘æ˜¯æœ‰åœ°æ–¹ä¸€ç›´åœ¨å¾€ä¸»çº¿ç¨‹ Looper ä¸­ æ·»åŠ æ¶ˆæ¯ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å®šä½æ˜¯ä»€ä¹ˆæ¶ˆæ¯å¯¼è‡´ä¸»çº¿ç¨‹ä¸€ç›´å¤„äºéç©ºé—²çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Looper.setMessageLogging()</code> æ¥æ‰“å°å‡ºä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ¶ˆæ¯:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Looper.getMainLooper().setMessageLogging(<span class="keyword">new</span> Printer() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(String x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (x.startsWith(<span class="string">"&gt;&gt;&gt;&gt;&gt;"</span>)) &#123;</span><br><span class="line">                Log.d(TAG, x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰ä¸ªåŠ¨ç”»ç»„ä»¶çš„æ¶ˆæ¯ä¸åœåœ°è¢«æ‰§è¡Œï¼Œç§»é™¤è¿™ä¸ªåŠ¨ç”»ç»„ä»¶åï¼Œé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå¹¶ä¸”æœªå‘ç°å…¶ä»–æ¯”è¾ƒæ˜æ˜¾çš„å¼‚å¸¸æ¶ˆæ¯ã€‚</p><p><img src="https://cdn.linroid.com/WX20180723-105051@2x.png" alt></p><p>æ—¢ç„¶ä¸»çº¿ç¨‹ä¸­ä¸€ç›´éç©ºé—²çŠ¶æ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠä¸»çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ¶ˆæ¯æ‰“å°å‡ºæ¥çœ‹çœ‹ï¼Ÿ</p><p>é€šè¿‡åå°„ï¼Œå¯åœ¨æ¯ä¸€å¸§çš„æ—¶å€™æ‰“å°å‡ºä¸»çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ¶ˆæ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Field messagesField;</span><br><span class="line"><span class="keyword">private</span> Field nextField;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        messagesField = MessageQueue.class.getDeclaredField("mMessages");</span><br><span class="line">        messagesField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        nextField = Message.class.getDeclaredField("next");</span><br><span class="line">        nextField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;        </span><br><span class="line">Choreographer.getInstance().postFrameCallback(<span class="keyword">new</span> Choreographer.FrameCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFrame</span><span class="params">(<span class="keyword">long</span> frameTimeNanos)</span> </span>&#123;</span><br><span class="line">                Choreographer.getInstance().postFrameCallback(<span class="keyword">this</span>);</span><br><span class="line">                Log.d(TAG, <span class="string">"doFrame"</span>);</span><br><span class="line">                printMessages();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printMessages</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MessageQueue queue = Looper.myQueue();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Message msg = (Message) messagesField.get(queue);</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> (msg != <span class="keyword">null</span>) &#123;</span><br><span class="line">            sb.append(msg.toString());</span><br><span class="line">            sb.append(<span class="string">"\n"</span>);</span><br><span class="line">            msg = (Message) nextField.get(msg);</span><br><span class="line">        &#125;</span><br><span class="line">        Log.i(TAG, sb.toString());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹æ—¥å¿—ï¼š<br><img src="https://cdn.linroid.com/blog/WX20180723-105818@2x.png" alt><br>å¯ä»¥çœ‹åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„å¤´éƒ¨å§‹ç»ˆæ˜¯ä¸€ä¸ª SyncBarrier æ¶ˆæ¯ï¼Œæœ‰è¿™ä¸ªæ¶ˆæ¯å­˜åœ¨çš„æ—¶å€™ï¼ŒMessageQueue åªä¼šå–ä¸‹ä¸€ä¸ª å¼‚æ­¥æ¶ˆæ¯ï¼Œè®©ç³»ç»Ÿçš„ UI äº‹ä»¶æ¶ˆæ¯å¾—åˆ°ä¼˜å…ˆå¤„ç†ã€‚ç”±æ­¤çŒœæµ‹ï¼Œæœ‰åœ°æ–¹ä¸åœåœ°å‘ MessageQueue ä¸­æ·»åŠ  SyncBarrierï¼Œé€šè¿‡å¯¹ <code>MessageQueue#postSyncBarrier()</code>æ–¹æ³•æ‰“è°ƒè¯•æ–­ç‚¹åï¼Œç»ˆäºå‘ç°äº†ç½ªé­ç¥¸é¦–ã€‚</p><p><img src="https://cdn.linroid.com/blog/WX20180723-193912@2x.png" alt></p><p>æŸ¥çœ‹ä»£ç åå‘ç°ï¼Œè™½ç„¶è¿™ä½ç«¥é‹åœ¨æ”¶åˆ° onGlobalLayout() å›è°ƒæ—¶çš„ç¡®è°ƒç”¨äº†<code>View.getViewTreeObserver().removeOnGlobalLayoutListener()</code> ï¼Œä½†åœ¨ä¸Šé¢æˆªå›¾ä¸­çš„ <code>fixBtnLayout</code>æ–¹æ³•ä¸­åˆæŠŠç›‘å¬å™¨é‡æ–°æ·»åŠ ä¸Šäº†ï¼Œæ‰€ä»¥å®é™…å¹¶æ²¡æœ‰æˆåŠŸç§»é™¤ï¼Œç›¸å½“äºè¿™é‡Œå‡ºç°ä¸€ä¸ªâ€œå¼‚æ­¥çš„æ­»å¾ªç¯â€œã€‚</p><p>åœ¨ OnGlobalLayoutListener ä¸­æ›´æ–°äº†å¸ƒå±€çš„ LayoutParams å¯¼è‡´è§¦å‘äº† requestLayout()ï¼Œè€Œ requestLayout ä¼šè°ƒç”¨ <code>MessageQueue#postSyncBarrier()</code>ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸­æœ‰ SyncBarrier æ¶ˆæ¯æ—¶ï¼ŒIdleHandler æ²¡æœ‰è¢«æ‰§è¡Œçš„åŸå› å¯ä»¥çœ‹ <code>MessageQueue#next()</code>çš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// If first time idle, then get the number of idlers to run.</span></span><br><span class="line"><span class="comment">// Idle handles only run if the queue is empty or if the first message</span></span><br><span class="line"><span class="comment">// in the queue (possibly a barrier) is due to be handled in the future.</span></span><br><span class="line"><span class="keyword">if</span> (pendingIdleHandlerCount &lt; <span class="number">0</span></span><br><span class="line">    &amp;&amp; (mMessages == <span class="keyword">null</span> || now &lt; mMessages.when)) &#123;</span><br><span class="line">    pendingIdleHandlerCount = mIdleHandlers.size();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pendingIdleHandlerCount &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// No idle handlers to run.  Loop and wait some more.</span></span><br><span class="line">    mBlocked = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºè¿™ä¸ªæ—¶å€™æ˜¯æœ‰æ¶ˆæ¯çš„ï¼Œæ‰€ä»¥ mMessages != nullï¼Œç”±ä¸Šé¢çš„æ—¥å¿—å¯ä»¥çœ‹åˆ° æ¶ˆæ¯é˜Ÿåˆ—å¤´éƒ¨æ¶ˆæ¯å§‹ç»ˆæ˜¯ when ä¸ºè´Ÿå€¼ï¼Œå¯¼è‡´ <code>now &lt; mMessages.when</code> ä¹Ÿä¸æˆç«‹ï¼Œæ‰€ä»¥ pendingIdleHandlerCount ä¼šä¸€ç›´ä¸º0ï¼Œç›´åˆ°è°ƒç”¨äº† <code>MessageQueue#removeSyncBarrier()</code> æ¥ç§»é™¤ SyncBarrier æ¶ˆæ¯ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆ Activity è¿˜æ˜¯èƒ½å›è°ƒ <code>onStop()</code> å‘¢ï¼Ÿè¿‡æ»¤æ‰ ActivityManager çš„æ¶ˆæ¯åå¯ä»¥çœ‹åˆ°ä¸€æ¡è¿™æ ·çš„æ—¥å¿—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">W/ActivityManager: Launch timeout has expired, giving up wake lock!</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ ActivityManagerService çš„è¶…æ—¶æœºåˆ¶ï¼Œè€Œè¿™ä¸ªæ—¶é—´æ­£å¥½æ˜¯10sï¼Œå…·ä½“å¯è§ ActivityStack ä¸­ <code>STOP_TIMEOUT</code>ã€‚è¶…æ—¶åä¼šæŠŠ Activity å¼ºåˆ¶ç½®ä¸º stop çŠ¶æ€ï¼Œè¿™æ—¶å€™ä¸ä¼šå†è§¦å‘ onGlobalLayoutï¼Œä»è€Œä¸ä¼šå†æœ‰ SyncBarrier æ¶ˆæ¯ï¼Œæ‰€ä»¥æœ€ç»ˆ IdleHandler å¾—åˆ°æ‰§è¡Œçš„æœºä¼šã€‚</p><h2 id="ç›¸å…³æºç "><a href="#ç›¸å…³æºç " class="headerlink" title="ç›¸å…³æºç "></a>ç›¸å…³æºç </h2><ul><li><a href="https://android.googlesource.com/platform/frameworks/base.git/+/master/services/core/java/com/android/server/am/ActivityStack.java" target="_blank" rel="noopener">ActivityStack.java</a></li><li><a href="https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/MessageQueue.java" target="_blank" rel="noopener">MessageQueue.java</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºæˆ‘ä»¬çš„åº”ç”¨ä¾èµ– Activity çš„ onStop æ¥åœæ­¢æ’­æ”¾å™¨ï¼Œè¿‘æœŸå‘ç°é€€å‡ºç›´æ’­é—´åï¼Œå£°éŸ³å±…ç„¶æ®‹ç•™10s å·¦å³ï¼Œé€šè¿‡æ—¥å¿—å‘ç° Activity çš„ onStop åœ¨é€€å‡ºç•Œé¢åéœ€è¦10så·¦å³æ‰ä¼šè¢«æ‰§è¡Œï¼Œè¯¥å¦‚ä½•å®šä½è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Activity é”€æ¯çš„å»¶è¿Ÿ</title>
    <link href="http://linroid.com/2017/05/24/Pit-of-Activity-destory/"/>
    <id>http://linroid.com/2017/05/24/Pit-of-Activity-destory/</id>
    <published>2017-05-24T08:32:00.000Z</published>
    <updated>2019-12-21T15:53:13.850Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆçœ‹ä¸€å¼ æŒ‰ä¸‹ Back é”®ä¹‹åï¼ŒActivity ç”Ÿå‘½å‘¨æœŸå›è°ƒçš„æ—¥å¿—æˆªå›¾ï¼š<br><img src="https://cdn.linroid.com/activity_back_pressed.png" alt="ActivityBackPressed"><br>ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°å½“æŒ‰ä¸‹ Back é”®æ—¶ï¼Œå½“å‰çš„ Activity ä¼šé©¬ä¸Šå›è°ƒ onPause() æ–¹æ³•ï¼Œè€Œ onStop() æ˜¯åœ¨ MainActivity çš„ onResume()ä¹‹åæ‰è°ƒç”¨ï¼ŒonPause() ä¸ onStop()ä¹‹é—´ç›¸éš”äº†å¤§çº¦ 300msï¼Œä¹Ÿå°±æ˜¯è¯´ Activity ä¸æ˜¯é©¬ä¸Šè¢«é”€æ¯çš„ã€‚</p><p>å†çœ‹å¦ä¸€ä¸ªå¿«é€Ÿé‡æ–°æ‰“å¼€ <code>LifeActivity</code> çš„ Caseï¼š<br><img src="https://cdn.linroid.com/quick_reopen_actiivty.png" alt="QuickReopenActivity"></p><blockquote><p>è¿™é‡Œæˆ‘é‡‡ç”¨ä»£ç æ¨¡æ‹Ÿå¿«é€Ÿé‡æ–°æ‰“å¼€ <code>LifeActivity</code>ï¼Œfinish() åå»¶è¿Ÿ 300ms å†å¯åŠ¨ <code>LifeActivity</code>ã€‚å› ä¸ºæˆ‘ä»¬çš„ Activity é‡Œæ²¡åšä»€ä¹ˆäº‹ï¼Œæ‰€ä»¥å¾ˆéš¾æ‰‹åŠ¨é‡ç°å¿«é€Ÿé‡æ–°æ‰“å¼€ Activity çš„å¼‚å¸¸ Caseï¼Œè€Œå®é™…é¡¹ç›®å› ä¸ºé€»è¾‘å¤æ‚ï¼Œå¾€å¾€åœ¨1~2sæˆ–è€…æ›´é•¿çš„æ—¶é—´é‡Œå¾ˆå®¹æ˜“å¤ç°è¿™ç§æƒ…å†µã€‚</p></blockquote><p>å‡ºç°äº†è¯¡å¼‚çš„äº‹ï¼šLifeActivity[33732136] æ˜¯æ—§çš„ Activityï¼Œä½†å®ƒå´åœ¨æ–°çš„ LifeActivity[212157058] æ˜¾ç¤ºä¹‹åæ‰è¢«é”€æ¯çš„ï¼Œçœ‹åˆ°è¿™ä¸ªå¯èƒ½ä½ å·²ç»å¿ƒå¤´ä¸€å‡‰ã€‚è¿™ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿè¿™ä¼šè®©æˆ‘ä»¬ä¾èµ– Activity ç”Ÿå‘½å‘¨æœŸå›è°ƒæ¥åšèµ„æºå›æ”¶çš„ä»£ç å˜å¾—ä¸å¯é ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼šå¦‚æœæˆ‘ä»¬åœ¨ onStart() ä¸­å¯åŠ¨ç›¸æœºåœ¨ onStop() ä¸­å…³é—­ç›¸æœºï¼Œæ­£å¸¸é‡æ–°æ‰“å¼€è¿™ä¸ªé¡µé¢æ—¶ç›¸æœºçš„çŠ¶æ€æ“ä½œï¼šæ‰“å¼€ -&gt; å…³é—­ -&gt; æ‰“å¼€ï¼Œå¿«é€Ÿé‡æ–°æ‰“å¼€è¿™ä¸ª Activity æ—¶å°±å¯èƒ½ä¸æ˜¯è¿™ä¸ªé¡ºåºäº†ï¼šæ‰“å¼€-&gt;æ‰“å¼€-&gt;å…³é—­ã€‚ç„¶åç”¨æˆ·å°±é­æ®ƒäº†ï¼Œä»–å°†æ— æ³•æ­£å¸¸ä½¿ç”¨ä½ çš„åº”ç”¨äº†ï¼Œè€Œç”¨æˆ·åªæ˜¯å› ä¸ºæ‰‹é€Ÿè¿‡å¿«ã€‚<br><a id="more"></a></p><h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>é‚£ä¹ˆä¸ºä»€ä¹ˆ onPause() æ˜¯é©¬ä¸Šè¢«è°ƒç”¨ï¼Œè€Œ onStop() å’Œ onDestroy() å´è¢«å»¶è¿Ÿè¿™ä¹ˆä¹…å‘¢ï¼Ÿ</p><blockquote><p>å…³äº Activity é”€æ¯æµç¨‹çš„æºç æˆ‘ä¸ä¼šåšè¯¦ç»†åˆ†æï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ç›¸å…³æºç æˆ–è€…æœç´¢å…¶ä»–äººçš„æ–‡ç« çœ‹ä¸‹</p></blockquote><p>è°ƒç”¨ finish æ–¹æ³•åä¼šç»è¿‡ä»¥ä¸‹æµç¨‹å‘ <code>ActivityManagerService</code> è¯·æ±‚é”€æ¯å½“å‰ Activityï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MyActivity.finish() </span><br><span class="line">Activity.finish() </span><br><span class="line">ActivityManagerNative.getDefault().finishActivity() </span><br><span class="line">ActivityManagerService.finishActivity() </span><br><span class="line">ActivityStack.requestFinishActivityLocked() </span><br><span class="line">ActivityStack.finishActivityLocked() </span><br><span class="line">ActivityStack.startPausingLocked()</span><br></pre></td></tr></table></figure><p>ç„¶å <code>ActivityManagerService</code> å°±ä¼šè¯·æ±‚æ‰§è¡Œå½“å‰ Activity çš„ onPause() æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">IApplicationThread.schedulePauseActivity() </span><br><span class="line">ActivityThread.schedulePauseActivity() </span><br><span class="line">ActivityThread.sendMessage() </span><br><span class="line">ActivityThread.H.sendMessage() </span><br><span class="line">ActivityThread.H.handleMessage() </span><br><span class="line">ActivityThread.handlePauseActivity() </span><br><span class="line">ActivityThread.performPauseActivity() </span><br><span class="line">Instrumentation.callActivityOnPause() </span><br><span class="line">Activity.performPause() </span><br><span class="line">Activity.onPause() </span><br><span class="line">ActivityManagerNative.getDefault().activityPaused() </span><br><span class="line">ActivityManagerService.activityPaused() </span><br><span class="line">ActivityStack.activityPausedLocked() </span><br><span class="line">ActivityStack.completePauseLocked()</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ onPause() æ˜¯ç«‹å³è¢«æ‰§è¡Œçš„ï¼Œæ‰§è¡Œå®Œ onPause() åå¹¶æ²¡æœ‰é©¬ä¸Šé”€æ¯ Activityï¼Œè€Œæ˜¯å…ˆè®©ä¸€ä¸ª Activity æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™ä¸ª Activity å¯èƒ½æ˜¯å½“å‰åº”ç”¨ Activity æ ˆä¸­çš„ä¸€ä¸ª Activity ä¹Ÿå¯èƒ½æ˜¯ Launcher æˆ–è€…å…¶ä»–åº”ç”¨çš„ Activityï¼Œä¸ç®¡æ˜¯å“ªä¸ªéƒ½å¤§åŒå°å¼‚ï¼Œåœ¨ä¸Šé¢çš„ Case ä¸­å°±æ˜¯ MainActivityã€‚</p><p>æ‰§è¡Œä¸Šä¸€ä¸ª Activity å³ MainActivity çš„ onResume()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ActivityStack.resumeTopActivityLocked() </span><br><span class="line">ActivityStack.resumeTopInnerLocked() </span><br><span class="line">IApplicationThread.scheduleResumeActivity() </span><br><span class="line">ActivityThread.scheduleResumeActivity() </span><br><span class="line">ActivityThread.sendMessage() </span><br><span class="line">ActivityTherad.H.sendMessage() </span><br><span class="line">ActivityThread.H.handleMessage() </span><br><span class="line">ActivityThread.handleResumeActivity() </span><br><span class="line">Activity.performResume() </span><br><span class="line">Activity.performRestart() </span><br><span class="line">Instrumentation.callActivityOnRestart() </span><br><span class="line">Activity.onRestart() </span><br><span class="line">Activity.performStart() </span><br><span class="line">Instrumentation.callActivityOnStart() </span><br><span class="line">Activity.onStart() </span><br><span class="line">Instrumentation.callActivityOnResume() </span><br><span class="line">Activity.onResume()</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œä¸Šä¸€ä¸ª Activity çš„ onResume ä¹‹åï¼Œè¯¥è¿›è¡Œ Activity çš„é”€æ¯æ“ä½œäº†å§ï¼Ÿ<br>é€šè¿‡åå‘åˆ†æï¼Œå‘ç° Activity çš„é”€æ¯æ—¶é€šè¿‡è¯·æ±‚ ActivityManagerService çš„ activityIdle() æ–¹æ³•ï¼Œé”€æ¯æµç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Looper.myQueue().addIdleHandler(<span class="keyword">new</span> Idler()) </span><br><span class="line">ActivityManagerNative.getDefault().activityIdle() </span><br><span class="line">ActivityManagerService.activityIdle() </span><br><span class="line">ActivityStackSupervisor.activityIdleInternalLocked() </span><br><span class="line">ActivityStack.destroyActivityLocked() </span><br><span class="line">IApplicationThread.scheduleDestoryActivity() </span><br><span class="line">ActivityThread.scheduleDestoryActivity() </span><br><span class="line">ActivityThread.sendMessage() </span><br><span class="line">ActivityThread.H.sendMessage() </span><br><span class="line">ActivityThread.H.handleMessage() </span><br><span class="line">ActivityThread.handleDestoryActivity() </span><br><span class="line">ActivityThread.performDestoryActivity() </span><br><span class="line">Activity.performStop() </span><br><span class="line">Instrumentation.callActivityOnStop() </span><br><span class="line">Activity.onStop() </span><br><span class="line">Instrumentation.callActivityOnDestory() </span><br><span class="line">Activity.performDestory() </span><br><span class="line">Acitivity.onDestory() </span><br><span class="line">ActivityManagerNative.getDefault().activityDestoryed() </span><br><span class="line">ActivityManagerService.activityDestoryed() </span><br><span class="line">ActivityStack.activityDestoryedLocked()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª Idler å®ç°çš„æ˜¯ <code>MessageQueue.IdleHandler</code>ï¼ŒIdleHandler ä¼šç­‰åˆ° MessageQueue ä¸­å½“å‰æ²¡æœ‰å¯æ‰§è¡Œçš„æ¶ˆæ¯æ—¶æ‰ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ Activity ä¼šä¸€ç›´ç­‰å¾…ä¸»çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ä¸­å½“å‰æ¶ˆæ¯éƒ½å¤„ç†å®Œæ¯•äº†æ‰ä¼šè¿›è¡Œé”€æ¯ï¼Œè¿™ä¹Ÿå°±æ˜¯ Activity çš„é”€æ¯ä¸æ˜¯ç«‹å³æ‰§è¡Œçš„æ ¹æœ¬åŸå› ã€‚</p><h1 id="å¦‚ä½•é¿å…"><a href="#å¦‚ä½•é¿å…" class="headerlink" title="å¦‚ä½•é¿å…"></a>å¦‚ä½•é¿å…</h1><p>æ‰‹é€Ÿå¿«å¹¶ä¸æ˜¯ç”¨æˆ·çš„é”…ï¼Œè¦é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥ç”¨ä¸ªé™æ€å˜é‡ä¿å­˜å½“å‰ Activityï¼Œå¹¶ä¸”åœ¨é”€æ¯çš„æ—¶å€™åˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯ä¸ä¿å­˜çš„ä¸€è‡´ï¼Œä»¥ä¸‹ç»™å‡ºç¤ºä¾‹ä»£ç ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿å‘Šè¯‰æˆ‘ :)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LifeActivity sCurrentLifeActivity;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        sCurrentLifeActivity = <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart();</span><br><span class="line">        someResource.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop();</span><br><span class="line">        <span class="keyword">if</span> (sCurrentLifeActivity == <span class="keyword">this</span>) &#123;</span><br><span class="line">            someResource.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        <span class="keyword">if</span> (sCurrentLifeActivity == <span class="keyword">this</span>) &#123;</span><br><span class="line">            sCurrentLifeActivity = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…ˆçœ‹ä¸€å¼ æŒ‰ä¸‹ Back é”®ä¹‹åï¼ŒActivity ç”Ÿå‘½å‘¨æœŸå›è°ƒçš„æ—¥å¿—æˆªå›¾ï¼š&lt;br&gt;&lt;img src=&quot;https://cdn.linroid.com/activity_back_pressed.png&quot; alt=&quot;ActivityBackPressed&quot;&gt;&lt;br&gt;ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°å½“æŒ‰ä¸‹ Back é”®æ—¶ï¼Œå½“å‰çš„ Activity ä¼šé©¬ä¸Šå›è°ƒ onPause() æ–¹æ³•ï¼Œè€Œ onStop() æ˜¯åœ¨ MainActivity çš„ onResume()ä¹‹åæ‰è°ƒç”¨ï¼ŒonPause() ä¸ onStop()ä¹‹é—´ç›¸éš”äº†å¤§çº¦ 300msï¼Œä¹Ÿå°±æ˜¯è¯´ Activity ä¸æ˜¯é©¬ä¸Šè¢«é”€æ¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;å†çœ‹å¦ä¸€ä¸ªå¿«é€Ÿé‡æ–°æ‰“å¼€ &lt;code&gt;LifeActivity&lt;/code&gt; çš„ Caseï¼š&lt;br&gt;&lt;img src=&quot;https://cdn.linroid.com/quick_reopen_actiivty.png&quot; alt=&quot;QuickReopenActivity&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œæˆ‘é‡‡ç”¨ä»£ç æ¨¡æ‹Ÿå¿«é€Ÿé‡æ–°æ‰“å¼€ &lt;code&gt;LifeActivity&lt;/code&gt;ï¼Œfinish() åå»¶è¿Ÿ 300ms å†å¯åŠ¨ &lt;code&gt;LifeActivity&lt;/code&gt;ã€‚å› ä¸ºæˆ‘ä»¬çš„ Activity é‡Œæ²¡åšä»€ä¹ˆäº‹ï¼Œæ‰€ä»¥å¾ˆéš¾æ‰‹åŠ¨é‡ç°å¿«é€Ÿé‡æ–°æ‰“å¼€ Activity çš„å¼‚å¸¸ Caseï¼Œè€Œå®é™…é¡¹ç›®å› ä¸ºé€»è¾‘å¤æ‚ï¼Œå¾€å¾€åœ¨1~2sæˆ–è€…æ›´é•¿çš„æ—¶é—´é‡Œå¾ˆå®¹æ˜“å¤ç°è¿™ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‡ºç°äº†è¯¡å¼‚çš„äº‹ï¼šLifeActivity[33732136] æ˜¯æ—§çš„ Activityï¼Œä½†å®ƒå´åœ¨æ–°çš„ LifeActivity[212157058] æ˜¾ç¤ºä¹‹åæ‰è¢«é”€æ¯çš„ï¼Œçœ‹åˆ°è¿™ä¸ªå¯èƒ½ä½ å·²ç»å¿ƒå¤´ä¸€å‡‰ã€‚è¿™ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿè¿™ä¼šè®©æˆ‘ä»¬ä¾èµ– Activity ç”Ÿå‘½å‘¨æœŸå›è°ƒæ¥åšèµ„æºå›æ”¶çš„ä»£ç å˜å¾—ä¸å¯é ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªæ —å­ï¼šå¦‚æœæˆ‘ä»¬åœ¨ onStart() ä¸­å¯åŠ¨ç›¸æœºåœ¨ onStop() ä¸­å…³é—­ç›¸æœºï¼Œæ­£å¸¸é‡æ–°æ‰“å¼€è¿™ä¸ªé¡µé¢æ—¶ç›¸æœºçš„çŠ¶æ€æ“ä½œï¼šæ‰“å¼€ -&amp;gt; å…³é—­ -&amp;gt; æ‰“å¼€ï¼Œå¿«é€Ÿé‡æ–°æ‰“å¼€è¿™ä¸ª Activity æ—¶å°±å¯èƒ½ä¸æ˜¯è¿™ä¸ªé¡ºåºäº†ï¼šæ‰“å¼€-&amp;gt;æ‰“å¼€-&amp;gt;å…³é—­ã€‚ç„¶åç”¨æˆ·å°±é­æ®ƒäº†ï¼Œä»–å°†æ— æ³•æ­£å¸¸ä½¿ç”¨ä½ çš„åº”ç”¨äº†ï¼Œè€Œç”¨æˆ·åªæ˜¯å› ä¸ºæ‰‹é€Ÿè¿‡å¿«ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="è¸©å‘" scheme="http://linroid.com/tags/%E8%B8%A9%E5%9D%91/"/>
    
  </entry>
  
  <entry>
    <title>ArrayList å¯¼è‡´çš„å†…å­˜æ³„éœ²</title>
    <link href="http://linroid.com/2017/05/24/Memory-leak-caused-by-ArrayList/"/>
    <id>http://linroid.com/2017/05/24/Memory-leak-caused-by-ArrayList/</id>
    <published>2017-05-24T06:25:54.000Z</published>
    <updated>2019-12-21T15:53:13.849Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´åœ¨æ’æŸ¥ä¸€å¤„å†…å­˜æ³„éœ²æ—¶ï¼Œå‘ç°æ˜¯æ³¨å†Œçš„ä¸€ä¸ªç›‘å¬å™¨å¯¼è‡´çš„ã€‚ä½†æ£€æŸ¥äº†è¿™ä¸ªç›‘å¬å™¨åœ¨è¯¥å–æ¶ˆæ³¨å†Œçš„åœ°æ–¹çš„ç¡®å–æ¶ˆæ³¨å†Œäº†ï¼Œé‚£å†…å­˜ä¸­ä¸ºä»€ä¹ˆè¿˜æœ‰å®ƒçš„å¼•ç”¨å‘¢ï¼Ÿ</p><a id="more"></a><p>åˆ†æå†…å­˜å‘ç°æ˜¯ ArrayList å¯¹å®ƒè¿›è¡Œäº†æŒæœ‰ï¼Œä½†çš„ç¡®è°ƒç”¨äº† remove æ¥ç§»é™¤è¿™ä¸ªç›‘å¬å™¨å‘€ã€‚æ‰“æ–­ç‚¹å‘ç°æ³¨å†Œç›‘å¬å™¨çš„æ–¹æ³•è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œå³è°ƒç”¨äº†ä¸¤æ¬¡ ArrayList çš„ add æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ArrayList çš„ add æ–¹æ³•å¹¶æ²¡æœ‰è¿›è¡Œå»é‡æ“ä½œï¼Œæ‰€ä»¥ä¸¤æ¬¡ add éƒ½ä¼šæˆåŠŸã€‚ä½† remove æ–¹æ³•å´åªè°ƒç”¨äº†ä¸€æ¬¡ï¼Œæ¥çœ‹çœ‹ remove çš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œremove æ–¹æ³•ä¼šéå†æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä¸€æ—¦æ‰¾åˆ°è¿™ä¸ªç›‘å¬å™¨ï¼Œå°±ä¼š returnï¼Œå³ä¸€æ¬¡ remove åªä¼šç§»é™¤ä¸€ä¸ªå¼•ç”¨ã€‚ä½†æˆ‘ä»¬è°ƒç”¨äº†ä¸¤æ¬¡ add æ–¹æ³•ï¼Œæ‰€ä»¥ ArrayList ä¾ç„¶æŒæœ‰ è¿™ä¸ªç›‘å¬å™¨çš„å¼•ç”¨ã€‚</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><ul><li>åœ¨ add çš„æ—¶å€™åˆ¤æ–­ä¸‹ ArrayList ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªå¯¹è±¡ï¼Œå¦‚æœæœ‰åˆ™å¿½ç•¥è¿™æ¬¡æ“ä½œ</li><li>ä½¿ç”¨ HashSet ä»£æ›¿ ArrayListï¼ŒHashSet åœ¨æ·»åŠ çš„æ—¶å€™ä¼šè¿›è¡Œå»é‡</li></ul><h1 id="åæ€"><a href="#åæ€" class="headerlink" title="åæ€"></a>åæ€</h1><p>  å…¶å®ä½¿ç”¨ ArrayList æ¥ä½œä¸ºå­˜æ”¾ç›‘å¬å™¨çš„é›†åˆæ˜¯å¾ˆå¸¸è§çš„ï¼Œæ¯”å¦‚åœ¨ <code>RecyclerView</code>ä¸­ <code>mItemDecorations</code>ã€<code>mOnItemTouchListeners</code>ã€<code>mOnChildAttachStateListeners</code>ã€<br>  <code>mPendingAccessibilityImportanceChange</code>ã€<code>mScrollListeners</code> ç­‰å±æ€§éƒ½æ˜¯ä½¿ç”¨ ArrayList æ¥ä¿å­˜çš„ï¼Œå¹¶ä¸”æ²¡æœ‰åšå»é‡å¤„ç†ã€‚å¦‚æœè¿™ä¸ª ArrayList æ”¾åœ¨å•ä¾‹ä¸­å¹¶ä¸”åª remove äº†ä¸€æ¬¡ï¼Œé‡å¤çš„æ·»åŠ å°±ä¼šå¯¼è‡´å†…å­˜æ³„éœ²ï¼›è€Œåœ¨ä½¿ç”¨æ—¶çš„éå†åˆä¼šå› é‡å¤è°ƒç”¨å¯¼è‡´æ€§èƒ½æˆ–å…¶ä»–é—®é¢˜ã€‚</p><p>  æ‰€ä»¥æˆ‘ä»¬å¹³æ—¶åœ¨é‡åˆ°å¾€ ArrayList ä¸­æ·»åŠ å¯¹è±¡æ—¶ä¸€å®šè¦æ³¨æ„è¿™ç‚¹ï¼Œå½“ç„¶æˆ‘ä¸ªäººæ›´å»ºè®®ä½¿ç”¨ HashSet æ¥ä¿å­˜ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½åœ°é¿å…å›¢é˜Ÿé‡Œå…¶ä»–æˆå‘˜åœ¨ä½¿ç”¨æ—¶å‡ºç°é—®é¢˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰æ®µæ—¶é—´åœ¨æ’æŸ¥ä¸€å¤„å†…å­˜æ³„éœ²æ—¶ï¼Œå‘ç°æ˜¯æ³¨å†Œçš„ä¸€ä¸ªç›‘å¬å™¨å¯¼è‡´çš„ã€‚ä½†æ£€æŸ¥äº†è¿™ä¸ªç›‘å¬å™¨åœ¨è¯¥å–æ¶ˆæ³¨å†Œçš„åœ°æ–¹çš„ç¡®å–æ¶ˆæ³¨å†Œäº†ï¼Œé‚£å†…å­˜ä¸­ä¸ºä»€ä¹ˆè¿˜æœ‰å®ƒçš„å¼•ç”¨å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
    
      <category term="å†…å­˜æ³„éœ²" scheme="http://linroid.com/tags/%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒWrapperã€è®©ä½ æ›´æ„‰å¿«åœ°è°ƒç”¨ Listener</title>
    <link href="http://linroid.com/2017/03/19/introduce-wrapper/"/>
    <id>http://linroid.com/2017/03/19/introduce-wrapper/</id>
    <published>2017-03-19T06:11:22.000Z</published>
    <updated>2019-12-21T15:53:13.851Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨ <a href="https://github.com/linroid/Wrapper" target="_blank" rel="noopener">GitHub</a> æŸ¥çœ‹</p></blockquote><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>Android å¼€å‘ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šæƒ…å†µä¸‹ç”¨åˆ°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¦‚æœä½ è‡ªå®šä¹‰äº†ä¸€ä¸ª Listenerï¼Œåœ¨éœ€è¦è°ƒç”¨ä»–ä»¬æ¥é€šçŸ¥è§‚å¯Ÿè€…æ—¶ï¼Œæˆ–è®¸ä¼šé‡åˆ°ä»¥ä¸‹å‡ ç‚¹å¤´ç–¼çš„é—®é¢˜ï¼š</p><ul><li><p>è¿™ä¸ª Listener æ˜¯ Nullable çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡è°ƒç”¨å‰éƒ½éœ€è¦ä½œåˆ¤ç©ºå¤„ç†</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (listener != <span class="keyword">null</span>) &#123;</span><br><span class="line">listener.foo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>äº‹ä»¶æ˜¯åœ¨å…¶ä»–çº¿ç¨‹ä¸­å‘å‡ºï¼Œè€Œè§‚å¯Ÿè€…éœ€è¦åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼ˆé€šå¸¸æ˜¯ UI çº¿ç¨‹ï¼‰å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™åš <code>Handler#post</code>æ“ä½œ</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Looper.myLooper() != Looper.getMainLooper()) &#123;</span><br><span class="line">handler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">listener.foo();</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">listener.foo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>å¦‚æœè§‚å¯Ÿè€…å¯ä»¥æ³¨å†Œå¤šä¸ªï¼Œé‚£æ¯æ¬¡åœ¨è°ƒç”¨çš„æ—¶å€™çš„æ—¶å€™éƒ½éœ€è¦éå†ä¸€ä¸‹æ‰€æœ‰ Listener</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">final</span> FooListener listener : listener) &#123;</span><br><span class="line">   listener.foo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>è¿™ä¸‰ç§æƒ…å†µå¯èƒ½ä¼šåŒæ—¶å‡ºç°ï¼Œæ¯”å¦‚åœ¨åšä¸ Service é€šä¿¡æ—¶æ˜¯å¾ˆå¸¸è§çš„ï¼Œå¦‚æœå›è°ƒæ–¹æ³•æ›´å¤šæ—¶ï¼Œä»£ç å†™èµ·æ¥é‚£æ˜¯ç›¸å½“ç—›è‹¦ğŸ˜‚<br><a id="more"></a> </p><h1 id="é€ è½®å­"><a href="#é€ è½®å­" class="headerlink" title="é€ è½®å­"></a>é€ è½®å­</h1><p> åŸºäºä¸Šé¢çš„åŸå› ï¼Œäºæ˜¯æˆ‘æ’¸ä¸€ä¸ªè½®å­ï¼Œå°±å«ã€ŒWrapperã€ã€‚å®ƒåˆ©ç”¨ AnnotationProcessor åœ¨æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨ç”ŸæˆæŒ‡å®š Listener çš„ Wrapper ç±»ï¼Œåœ¨éœ€è¦æ—¶åªéœ€ç®€ç®€å•å•çš„è°ƒç”¨ä¸€ä¸‹æ–¹æ³•å³å¯ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">listener.foo();</span><br></pre></td></tr></table></figure><p> Wrapper ä¼šæ ¹æ®éœ€è¦ç”Ÿæˆåˆ¤ç©ºå¤„ç†ã€postã€éå†ç­‰ä»£ç ï¼Œä»ç¼–å†™ç¹çæ— è¶£çš„ä»£ç ä¸­è§£æ”¾å‡ºæ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WrapperClass</span></span><br><span class="line"><span class="meta">@WrapperMultiple</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@UiThread</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onFoo</span><span class="params">(View view)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">onUserLeave</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡ã€ŒWrapperã€çš„å¤„ç†ï¼Œä¼šç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.linroid.wrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Looper;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeListenerMultiWrapper</span> <span class="keyword">implements</span> <span class="title">SomeListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HashSet&lt;SomeListener&gt; _delegates = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Handler _handler;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SomeListenerMultiWrapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._handler = <span class="keyword">new</span> Handler(Looper.getMainLooper());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SomeListenerMultiWrapper</span><span class="params">(Handler _handler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>._handler = _handler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">addWrapper</span><span class="params">(SomeListener _delegate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (_delegate != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>._delegates.add(_delegate);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">removeWrapper</span><span class="params">(SomeListener _delegate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._delegates.remove(_delegate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onUserLeave</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> SomeListener _delegate : _delegates) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_delegate != <span class="keyword">null</span>) &#123;</span><br><span class="line">                _delegate.onUserLeave();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFoo</span><span class="params">(<span class="keyword">final</span> View view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Looper.myLooper() == <span class="keyword">null</span> || Looper.myLooper() != _handler.getLooper()) &#123;</span><br><span class="line">            _handler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">final</span> SomeListener _delegate : _delegates) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (_delegate != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            _delegate.onFoo(view);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">final</span> SomeListener _delegate : _delegates) &#123;</span><br><span class="line">                <span class="keyword">if</span> (_delegate != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    _delegate.onFoo(view);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨ã€ŒWrapperã€"><a href="#ä½¿ç”¨ã€ŒWrapperã€" class="headerlink" title="ä½¿ç”¨ã€ŒWrapperã€"></a>ä½¿ç”¨ã€ŒWrapperã€</h1><h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>åœ¨ä½ çš„ <code>build.gradle</code>ï¼š<br>    <figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    annotationProcessor <span class="string">'com.linroid.wrapper:compiler:0.1.0'</span></span><br><span class="line">    compile <span class="string">'com.linroid.wrapper:library:0.1.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å¯ä»¥ä½¿ç”¨çš„æ³¨è§£ï¼š"><a href="#å¯ä»¥ä½¿ç”¨çš„æ³¨è§£ï¼š" class="headerlink" title="å¯ä»¥ä½¿ç”¨çš„æ³¨è§£ï¼š"></a>å¯ä»¥ä½¿ç”¨çš„æ³¨è§£ï¼š</h2><ul><li><p><code>@WrapperClass</code> å¯¹å•ä¸ªæ¥å£ / ç±»è¿›è¡Œå¤„ç†ï¼Œé»˜è®¤åªä¼šè¿›è¡Œåˆ¤ç©ºå¤„ç†</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WrapperClass</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeListener</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onFoo</span><span class="params">(View view)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>@UiThread</code> éœ€è¦è¿›è¡Œ <code>Handler#post</code> å¤„ç†ï¼Œå¯ä»¥ç”¨åœ¨æ–¹æ³•æˆ–è€…ç±» / æ¥å£ä¸Šï¼Œå¦‚æœç”¨åœ¨ç±» / æ¥å£ï¼Œä¼šå¯¹æ‰€æœ‰æ–¹æ³•è¿›è¡Œå¤„ç†</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// @UiThread // ä¼šå¯¹æ‰€æœ‰æ–¹æ³•ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta">@WrapperClass</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeListener</span> </span>&#123;</span><br><span class="line"><span class="meta">@UiThread</span> <span class="comment">// åªå¯¹æŒ‡å®šæ–¹æ³•ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onFoo</span><span class="params">(View view)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">onUserLeave</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>@WrapperMultiple</code> æ”¯æŒå¤šä¸ª Listener</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WrapperClass</span></span><br><span class="line"><span class="meta">@WrapperMultiple</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onFoo</span><span class="params">(View view)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>@WrapperGenerator</code> ä¸<code>@WrapperClass</code> ä¸åŒï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºçš„ Classï¼Œå°†æ‰€æœ‰éœ€è¦å¤„ç†çš„æ¥å£ / ç±»æ·»åŠ è¿›æ¥ï¼ˆè¿™æ ·å°±å¯ä»¥å¤„ç†ä½ æ— æ³•ä¿®æ”¹çš„ä¸€äº› Listener äº†ï¼Œæ¯”å¦‚ Android SDK ä¸­çš„ï¼‰ã€‚</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WrapperGenerator</span>(</span><br><span class="line">        values = &#123;</span><br><span class="line">                View.OnClickListener<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">                <span class="title">View</span>.<span class="title">OnLongClickListener</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">                <span class="title">MenuItem</span>.<span class="title">OnMenuItemClickListener</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">                <span class="title">View</span>.<span class="title">OnScrollChangeListener</span>.<span class="title">class</span></span></span><br><span class="line"><span class="class">        &#125;</span></span><br><span class="line"><span class="class">)</span></span><br><span class="line"><span class="class">@<span class="title">UiThread</span></span></span><br><span class="line"><span class="class">@<span class="title">WrapperMultiple</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SomeGenerator</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h2><p>ç»è¿‡ Wrapper çš„å¤„ç†ï¼Œä¼šç”Ÿæˆä¸€ä¸ªåŒ…åç›¸åŒçš„ <code>XXXWrapper</code> çš„ç±»ï¼Œå¦‚æœæ·»åŠ äº† <code>@ WrapperMultiple</code> æ³¨è§£ï¼Œä¼šé¢å¤–ç”Ÿæˆä¸€ä¸ª <code>XXXMultiWrapper</code> ç±»ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå¤„ç†çš„æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ Wrapper ä¼šå®ç°è¿™ä¸ªæ¥å£ï¼›è€Œå¦‚æœå¤„ç†çš„æ˜¯ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ Wrapper ä¸ä¼šç»§æ‰¿è¿™ä¸ªç±»ã€‚</p><p>æ·»åŠ å®Œæ³¨è§£åœ¨æ‰§è¡Œä¸€æ¬¡ build åï¼ŒWrapper å°±ä¼šç”Ÿæˆå¥½ç›¸åº”çš„ <code>XXXWrapper</code> ç±»ï¼Œä½¿ç”¨å®ƒä»¬éå¸¸ç®€å•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SomeListenerWrapper wrapper = <span class="keyword">new</span> SomeListenerWrapper(listener);</span><br><span class="line"><span class="comment">// SomeListener wrapper = new SomeListenerWrapper(handler, listener); // è‡ªå·±æŒ‡å®šä¸€ä¸ª Handler</span></span><br><span class="line">wrapper.setWrapper(listener); <span class="comment">// è®¾ç½®ä½ å®ç°çš„ listener</span></span><br><span class="line">wrapper.onFoo(view); <span class="comment">// è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">SomeListenerMultiWrapper multiWrapper = <span class="keyword">new</span> SomeListenerMultiWrapper();</span><br><span class="line"><span class="comment">// SomeListenerMultiWrapper multiWrapper = new SomeListenerMultiWrapper(handler); // è‡ªå·±æŒ‡å®šä¸€ä¸ª Handler</span></span><br><span class="line">multiWrapper.addWrapper(listener); <span class="comment">// æ·»åŠ  listener</span></span><br><span class="line">multiWrapper.onFoo(view); <span class="comment">// è°ƒç”¨æ–¹æ³•</span></span><br></pre></td></tr></table></figure><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>å¦‚æœä½ æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®å¯ä»¥åœ¨è¯„è®ºç•™è¨€ï¼Œä¹Ÿå¯ä»¥æ <a href="https://github.com/linroid/Wrapper/pulls" target="_blank" rel="noopener">PR</a> :)<br>(å—¯ï¼Œæˆ‘çŸ¥é“ kotlin å¤§æ³•ğŸ’</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨ &lt;a href=&quot;https://github.com/linroid/Wrapper&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitHub&lt;/a&gt; æŸ¥çœ‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;Android å¼€å‘ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šæƒ…å†µä¸‹ç”¨åˆ°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¦‚æœä½ è‡ªå®šä¹‰äº†ä¸€ä¸ª Listenerï¼Œåœ¨éœ€è¦è°ƒç”¨ä»–ä»¬æ¥é€šçŸ¥è§‚å¯Ÿè€…æ—¶ï¼Œæˆ–è®¸ä¼šé‡åˆ°ä»¥ä¸‹å‡ ç‚¹å¤´ç–¼çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è¿™ä¸ª Listener æ˜¯ Nullable çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡è°ƒç”¨å‰éƒ½éœ€è¦ä½œåˆ¤ç©ºå¤„ç†&lt;/p&gt;
 &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (listener != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	listener.foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;äº‹ä»¶æ˜¯åœ¨å…¶ä»–çº¿ç¨‹ä¸­å‘å‡ºï¼Œè€Œè§‚å¯Ÿè€…éœ€è¦åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼ˆé€šå¸¸æ˜¯ UI çº¿ç¨‹ï¼‰å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™åš &lt;code&gt;Handler#post&lt;/code&gt;æ“ä½œ&lt;/p&gt;
 &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(Looper.myLooper() != Looper.getMainLooper()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	handler.post(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Runnable() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			listener.foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	listener.foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¦‚æœè§‚å¯Ÿè€…å¯ä»¥æ³¨å†Œå¤šä¸ªï¼Œé‚£æ¯æ¬¡åœ¨è°ƒç”¨çš„æ—¶å€™çš„æ—¶å€™éƒ½éœ€è¦éå†ä¸€ä¸‹æ‰€æœ‰ Listener&lt;/p&gt;
 &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; FooListener listener : listener) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   listener.foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸‰ç§æƒ…å†µå¯èƒ½ä¼šåŒæ—¶å‡ºç°ï¼Œæ¯”å¦‚åœ¨åšä¸ Service é€šä¿¡æ—¶æ˜¯å¾ˆå¸¸è§çš„ï¼Œå¦‚æœå›è°ƒæ–¹æ³•æ›´å¤šæ—¶ï¼Œä»£ç å†™èµ·æ¥é‚£æ˜¯ç›¸å½“ç—›è‹¦ğŸ˜‚&lt;br&gt;
    
    </summary>
    
    
      <category term="Android" scheme="http://linroid.com/tags/Android/"/>
    
      <category term="é€ è½®å­" scheme="http://linroid.com/tags/%E9%80%A0%E8%BD%AE%E5%AD%90/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„2016</title>
    <link href="http://linroid.com/2017/01/23/2016-summary/"/>
    <id>http://linroid.com/2017/01/23/2016-summary/</id>
    <published>2017-01-23T02:21:54.000Z</published>
    <updated>2019-12-21T15:56:22.029Z</updated>
    
    <content type="html"><![CDATA[<p>2016 å¹´ï¼Œåœ¨æˆ‘äººç”Ÿä¸­æ˜¯å˜åŒ–å¾ˆå¤§çš„ä¸€å¹´<br><a id="more"></a></p><p>é¦–å…ˆæˆ‘æ¯•ä¸šäº†ï¼Œå­¦æ ¡çš„å¾ˆå¤šå°ä¼™ä¼´ä»¬éƒ½å¾ˆéš¾å†ç›¸è§ï¼Œå¾ˆæƒ³å¿µä»–ä»¬:)<br><img src="http://7u2rtn.com1.z0.glb.clouddn.com/21485138698_.pic_hd.jpg" alt="å°ä¼™ä¼´ä»¬"></p><p>åœ¨å­¦æ ¡çš„æœ€åä¸€æ®µæ—¶é—´é‡Œè®¤è¯†æˆ‘çš„å¥¹ï¼Œæˆ‘ä»¬ä¸€èµ·æ¯•ä¸šï¼Œä¸€èµ·ç»å†ç”±å­¦ç”Ÿå˜æˆæ‰“å·¥ä»”çš„è¿‡ç¨‹ã€‚å¾ˆé«˜å…´é‡åˆ°ä½ ï¼Œæˆ‘ä»¬çš„è·¯è¿˜å¾ˆé•¿:)<br><img src="http://7u2rtn.com1.z0.glb.clouddn.com/zl_xy_graduation_photo.jpeg" alt="æˆ‘ä»¬ä¸€èµ·æ¯•ä¸š"></p><p>è¾äº†ä¸¤æ¬¡å·¥ä½œï¼Œä¸€æ¬¡æ˜¯å› ä¸ºä¸¤åƒå¤šå…¬é‡Œçš„è·ç¦»ï¼Œä¸€æ¬¡æ˜¯ä¸ºäº†è®©è‡ªå·±è¿‡å¾—æ›´å¥½</p><p>è¿™ä¸€å¹´ä¸­åœ¨æŠ€æœ¯ä¸Šæˆ‘å¼€å§‹æ›´æ³¨é‡åŸºç¡€ç†è®ºçŸ¥è¯†å’Œæ¶æ„è®¾è®¡ï¼Œå¯¹è¿‡å»è¿½æ±‚çš„å„ç§åä¸½çš„åº“å…´è¶£é€æ¸ä¸‹é™ã€‚GitHub ä¸Šé¢çš„åŠ¨æ€å°‘äº†è®¸å¤š:(<br><img src="http://7u2rtn.com1.z0.glb.clouddn.com/WX20170123-110236@2x.png" alt="GitHub 2016"></p><p>å·¥ä½œä¸Šï¼Œå¼€å§‹æ³¨é‡ä¸åŒäº‹çš„ç›¸å¤„ï¼Œèƒ½å¤Ÿå’Œäº§å“æ’•é€¼</p><p>å»è¿‡æµ·è¾¹ï¼Œåè¿‡æ¸¸è½®ï¼Œåˆ°è¿‡è‰åŸï¼Œç©è¿‡è¿‡å±±è½¦ï¼Œè¿™æ¬¡å›å®¶è¿˜èƒ½åä¸‹é£æœºï¼›ç»å†è¿‡åœ¨åŒ—äº¬çš„å†¬å¤©é‡Œåƒè¥¿ç“œï¼Œå¹¿å·çš„å†¬å¤©é‡Œç©¿çŸ­è¢–=ã€‚=<br><a href="https://www.instagram.com/linroid/" target="_blank" rel="noopener">Instagram</a></p><p><img src="http://7u2rtn.com1.z0.glb.clouddn.com/linroid_instagram_2016.png" alt="Instagram 2016"></p><p>å°è¯•è‡ªå·±åšé¥­åƒï¼Œè™½ç„¶åšå¾—ä¸å¥½ï¼Œä½†èƒ½è®©è‡ªå·±åƒé¥±:)</p><hr><p>2017 å¹´ï¼Œå¸Œæœ›è‡ªå·±èƒ½èµšæ›´å¤šçš„é’±ï¼šï¼‰</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2016 å¹´ï¼Œåœ¨æˆ‘äººç”Ÿä¸­æ˜¯å˜åŒ–å¾ˆå¤§çš„ä¸€å¹´&lt;br&gt;
    
    </summary>
    
    
      <category term="æ€»ç»“" scheme="http://linroid.com/tags/%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>è°ƒç”¨å®Œ Handler#removeCallbacks() å°±å®‰å…¨äº†å—?</title>
    <link href="http://linroid.com/2016/11/25/Safety-after-invoke-Handler-removeCallbacks/"/>
    <id>http://linroid.com/2016/11/25/Safety-after-invoke-Handler-removeCallbacks/</id>
    <published>2016-11-25T03:51:31.000Z</published>
    <updated>2019-12-21T15:53:13.850Z</updated>
    
    <content type="html"><![CDATA[<p>ã€€ã€€<code>Handler</code> å®¹æ˜“å¼•èµ·å†…å­˜æ³„éœ²ï¼Œè¿™æ˜¯å¤§å®¶éƒ½çŸ¥é“çš„ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä¼šåœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨ <code>removeCallbacks()</code> æ–¹æ³•æ¥ç§»é™¤æ¶ˆæ¯ã€‚ä½†å½“ä»¥ä¸‹ä½¿ç”¨åœºæ™¯æ—¶ï¼Œä¾ç„¶å¯èƒ½ä¼šå‡ºç°å†…å­˜æ³„éœ²ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">private</span> HandlerThread mDaemonHandler;</span><br><span class="line"></span><br><span class="line">Runnable mTimerRunnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    longTimeOperation();</span><br><span class="line">    Daemon.handler().postDelayed(<span class="keyword">this</span>, DELAY_INTERVAL);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestory</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">mDaemonHandler.removeCallbacks(mTimerRunnable)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€<code>mTimerRunnable</code> æ˜¯ä¸€ä¸ªåœ¨éä¸»çº¿ç¨‹ä¸­è¿è¡Œçš„å¾ªç¯æ“ä½œï¼Œä¸€æ—¦å¯åŠ¨äº†å®ƒï¼Œå°±ä¼šæ¯éš” <code>DELAY_INTERVAL</code> æ—¶é—´è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨ Activity é€€å‡ºæ—¶ï¼Œåº”è¯¥åœæ­¢å®ƒï¼Œå¦åˆ™å°±ä¼šå‡ºç°å†…å­˜æ³„éœ²ã€‚åœæ­¢å®ƒçš„æ–¹å¼å°±æ˜¯è°ƒç”¨ <code>removeCallbacks()</code> æŠŠå®ƒä»<code>mDaemonHandler</code> çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚<strong>ä½†è¿™ä¸€æ“ä½œå¦‚æœå¤„åœ¨ <code>mDaemonHandler</code> çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ <code>longTimeOperation()</code>æ—¶ï¼Œ<code>mTimerRunnable</code>ä¹‹åè¿˜æ˜¯ä¼šè¢«æ·»åŠ åˆ° <code>mDaemonHandler</code> çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚</strong><br>ã€€ã€€<br>ã€€ã€€è¦ä¿è¯æ¶ˆæ¯èƒ½å¤Ÿç§»é™¤æ‰ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> mDaemonHandler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mDaemonHandler.removeCallbacks(mTimerRunnable);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ã€€ã€€è¿™æ ·å°±ä¿è¯äº†ç§»é™¤ <code>mTimerRunnable</code> çš„æ“ä½œå’Œ <code>mDaemonHandler</code> åœ¨åŒä¸€çº¿ç¨‹ä¸­ï¼Œä¸ä¼šå’Œ <code>mTimerRunnable</code> ã€å¹¶å‘æ‰§è¡Œã€ã€‚å†™æˆæ›´é€šç”¨çš„ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Looper;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> linroid &lt;linroid@gmail.com&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 25/11/2016</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SafetyUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeCallbacks</span><span class="params">(<span class="keyword">final</span> Handler handler, <span class="keyword">final</span> Runnable callback)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (handler.getLooper() == Looper.myLooper()) &#123;</span><br><span class="line">            handler.removeCallbacks(callback);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            handler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    handler.removeCallbacks(callback);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeMessages</span><span class="params">(<span class="keyword">final</span> Handler handler, <span class="keyword">final</span> <span class="keyword">int</span> what)</span> </span>&#123;</span><br><span class="line">        removeMessages(handler, what, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeMessages</span><span class="params">(<span class="keyword">final</span> Handler handler, <span class="keyword">final</span> <span class="keyword">int</span> what, <span class="keyword">final</span> Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (handler.getLooper() == Looper.myLooper()) &#123;</span><br><span class="line">            handler.removeMessages(what, obj);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            handler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    handler.removeMessages(what, obj);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ã€€ã€€&lt;code&gt;Handler&lt;/code&gt; å®¹æ˜“å¼•èµ·å†…å­˜æ³„éœ²ï¼Œè¿™æ˜¯å¤§å®¶éƒ½çŸ¥é“çš„ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä¼šåœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨ &lt;code&gt;removeCallbacks()&lt;/code&gt; æ–¹æ³•æ¥ç§»é™¤æ¶ˆæ¯ã€‚ä½†å½“ä»¥ä¸‹ä½¿ç”¨åœºæ™¯æ—¶ï¼Œä¾ç„¶å¯èƒ½ä¼šå‡ºç°å†…å­˜æ³„éœ²ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Handler" scheme="http://linroid.com/tags/Handler/"/>
    
      <category term="å†…å­˜" scheme="http://linroid.com/tags/%E5%86%85%E5%AD%98/"/>
    
  </entry>
  
  <entry>
    <title>Android Orientation çš„å‘</title>
    <link href="http://linroid.com/2016/11/09/Pit-of-Android-Orientation/"/>
    <id>http://linroid.com/2016/11/09/Pit-of-Android-Orientation/</id>
    <published>2016-11-09T02:41:40.000Z</published>
    <updated>2019-12-21T15:53:13.850Z</updated>
    
    <content type="html"><![CDATA[<p>ã€€ã€€æœ€è¿‘åœ¨åš <a href="http://www.bigo.sg/index_pc.html" target="_blank" rel="noopener">Bigo Live</a> ç›´æ’­é—´çš„æ¨ªå±é€‚é…ï¼Œæ¨ªå±å’Œç«–å±ä¸‹ä¼šæœ‰ä¸€äº›çŠ¶æ€çš„å·®å¼‚ã€‚ä½†æˆ‘ä»¬çš„åº”ç”¨åœ¨æ¨ªå±ä¸‹ï¼Œåˆ‡æ¢åå°å†å›æ¥åï¼Œå‘ç°ä¸€äº›çŠ¶æ€æ˜¾ç¤ºä¸å¯¹ã€‚<br><a id="more"></a><br>ã€€ã€€çŒœæƒ³é—®é¢˜å‡ºç°åœ¨äº†æ¨ªç«–å±çŠ¶æ€åˆ¤æ–­ä¸Šï¼Œå…ˆçœ‹ä¸‹ä»£ç ï¼š<br>    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOrientationPortrait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ã€€ã€€é€šè¿‡è°ƒè¯•å‘ç°åº”ç”¨åˆ‡åå°ä¹‹åï¼Œ <code>isOrientationPortrait()</code> ä¼šè¿”å› trueï¼Œäºæ˜¯æ¢ä¸Šå¦ä¸€ç§æ¨ªç«–å±åˆ¤æ–­ï¼š<br>    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOrientationPortrait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getRequestedOrientation() == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ã€€ã€€è¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«åœ¨äº <code>Configuration.orientation</code> æ‹¿åˆ°çš„æ˜¯è®¾å¤‡çš„æ–¹å‘ï¼Œè€Œ <code>getRequestedOrientation()</code>æ‹¿åˆ°çš„æ˜¯ Activity è¯·æ±‚çš„æ–¹å‘ï¼ˆé€šè¿‡<code>AndroidManifes.xml</code>ä¸­è®¾ç½®æˆ–è€…é€šè¿‡ <code>setRequestOrientation()</code> æ”¹å˜)ã€‚<br>ã€€ã€€ä¿®æ”¹ä¹‹åï¼Œåº”ç”¨å¤„äºåå°æ—¶æ–¹å‘èƒ½åˆ¤æ–­æ­£å¸¸ï¼Œä½†ä¸€äº›åå°æ—¶ <code>inflate</code> çš„ View å´ä¸æ­£å¸¸æˆ–æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚äºæ˜¯å†™äº†ä¸€ä¸ª <code>Demo</code> æµ‹è¯•ä¸€ä¸‹ï¼š<a href="https://gist.github.com/linroid/0c8086db0bcdf0abc7c1220cac4eb7da" target="_blank" rel="noopener">Gist</a>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">V/MainActivity: â‡¢ onPause()</span><br><span class="line">D/MainActivity: getRequestedOrientation: landscape</span><br><span class="line">D/MainActivity: Configuration.orientation: landscape</span><br><span class="line">D/MainActivity: Layout View: landscape</span><br><span class="line">V/MainActivity: â‡  onPause [2ms]</span><br><span class="line"></span><br><span class="line">V/MainActivity: â‡¢ onStop()</span><br><span class="line">D/MainActivity: getRequestedOrientation: landscape</span><br><span class="line">D/MainActivity: Configuration.orientation: portrait</span><br><span class="line">D/MainActivity: Layout View: portrait</span><br><span class="line">V/MainActivity: â‡  onStop [2ms]</span><br></pre></td></tr></table></figure></p><p>ã€€ã€€ä»ä¸­å¯ä»¥å‘ç°ï¼Œä»åº”ç”¨æ¨ªå±çŠ¶æ€åˆ‡åˆ°åå° <code>Configuration.orientation</code> ä¼šåœ¨ <code>onStop()</code>å‘ç”Ÿæ”¹å˜ï¼Œè€Œ <code>LayoutInflater#inflate()</code> åŠ è½½çš„ View å–å†³äº<code>Configuration.orientation</code>ï¼Œä¸ <code>getRequestedOrientation()</code>æ— å…³ã€‚</p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>ã€€ã€€ç”± <code>LayoutInflater#inflate()</code> å¯ä»¥æ‰¾åˆ°å¸ƒå±€æ–‡ä»¶è·¯å¾„æ˜¯åœ¨ <code>Resources#loadXmlResourceParser()</code> ä¸­æ‹¿åˆ°çš„ï¼š<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">XmlResourceParser <span class="title">loadXmlResourceParser</span><span class="params">(@AnyRes <span class="keyword">int</span> id, @NonNull String type)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> NotFoundException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> TypedValue value = obtainTempTypedValue();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> ResourcesImpl impl = mResourcesImpl;</span><br><span class="line">        impl.getValue(id, value, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        releaseTempTypedValue(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>ResourcesImpl#getValue()</code>ï¼š<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getValue</span><span class="params">(@AnyRes <span class="keyword">int</span> id, TypedValue outValue, <span class="keyword">boolean</span> resolveRefs)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> NotFoundException </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> found = mAssets.getResourceValue(id, <span class="number">0</span>, outValue, resolveRefs);</span><br><span class="line">    <span class="keyword">if</span> (found) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException(<span class="string">"Resource ID #0x"</span> + Integer.toHexString(id));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>AssetsManager#getResourceValue()</code> ä¼šè°ƒç”¨ <code>AssetsManager#loadResourceValue()</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª Native æ–¹æ³•ï¼Œé‚£ä¹ˆ Native å±‚æ˜¯æ€æ ·è·å–æ–¹å‘çš„å‘¢ï¼Ÿ<br><code>ResourcesImpl#updateConfiguration()</code>ï¼š<br>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateConfiguration</span><span class="params">(Configuration config, DisplayMetrics metrics,</span></span></span><br><span class="line"><span class="function"><span class="params">                        CompatibilityInfo compat)</span> </span>&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">mAssets.setConfiguration(mConfiguration.mcc, mConfiguration.mnc,</span><br><span class="line">                    adjustLanguageTag(mConfiguration.getLocales().get(<span class="number">0</span>).toLanguageTag()),</span><br><span class="line">                    mConfiguration.orientation,</span><br><span class="line">                    mConfiguration.touchscreen,</span><br><span class="line">                    mConfiguration.densityDpi, mConfiguration.keyboard,</span><br><span class="line">                    keyboardHidden, mConfiguration.navigation, width, height,</span><br><span class="line">                    mConfiguration.smallestScreenWidthDp,</span><br><span class="line">                    mConfiguration.screenWidthDp, mConfiguration.screenHeightDp,</span><br><span class="line">                    mConfiguration.screenLayout, mConfiguration.uiMode,</span><br><span class="line">                    Build.VERSION.RESOURCES_SDK_INT);</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>AssetsManager#setConfiguration()</code> æ˜¯ Native å±‚çš„æ–¹æ³•ï¼Œç”±æ­¤å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒNative æ‰¾åˆ°å¸ƒå±€æ–‡ä»¶è·¯å¾„æ˜¯é€šè¿‡ Configuration.orientation æ¥åˆ¤æ–­æ–¹å‘çš„ï¼Œæ‰€ä»¥åº”ç”¨åå°æ—¶ä¼šåŠ è½½ç«–å±çš„èµ„æºã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><ul><li><p>æ¨ªç«–å±çš„åˆ¤æ–­ï¼š<br>ã€€ã€€å¯ä»¥é€šè¿‡ç»™ View è®¾ç½® Tag æˆ–è€…åˆ¤æ–­æŸä¸ª View æ˜¯å¦å­˜åœ¨ï¼Œæ¥åˆ¤æ–­åŠ è½½çš„æ˜¯å“ªä¸ªçŠ¶æ€çš„å¸ƒå±€æ–‡ä»¶ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOrientationPortrait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mRootView == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> getRequestedOrientation() == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"port"</span> .equals(mRootView.getTag());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åå°æ—¶èµ„æºçš„åŠ è½½ï¼š<br>å¦‚æœä½ çš„åº”ç”¨å¤„äºæ¨ªå±çŠ¶æ€ï¼Œ å°½é‡ä¸è¦åœ¨åº”ç”¨åå°æ—¶åŠ è½½ä¸å±å¹•æ–¹å‘æœ‰å…³çš„èµ„æºï¼Œå¦‚æœéè¦åŠ è½½å¯ä»¥é‡‡å–ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li>å°†èµ„æºæ–‡ä»¶æ”¹ä¸ºä¸åŒçš„åç§°ï¼ˆè®°å¾—è¦éƒ½æ”¾åˆ°æ²¡æœ‰landæ ‡è¯†çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå¦åˆ™ä¼šå‡ºç° Resources#NotFoundExceptionï¼‰ï¼Œç„¶åæ ¹æ®æ–¹å‘åˆ¤æ–­åŠ è½½å“ªä¸€ä¸ªã€‚</li><li>é€šè¿‡åå°„æ–¹å¼ä¿®æ”¹ Native å±‚çš„å±å¹•æ–¹å‘ï¼š<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å®šå±å¹•æ–¹å‘æ¥åŠ è½½èµ„æº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> linroid &lt;linroid@gmail.com&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 09/11/2016</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrientationResourceLoader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(Activity activity, Callback callback)</span> </span>&#123;</span><br><span class="line">        load(activity, activity.getRequestedOrientation() == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT, callback);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(Context context, <span class="keyword">boolean</span> isPortrait, @NonNull Callback callback)</span> </span>&#123;</span><br><span class="line">        Resources resources = context.getResources();</span><br><span class="line">        <span class="keyword">if</span> (isPortrait || context.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) &#123;</span><br><span class="line">            callback.onLoad(context, resources);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Method updateConfiguration = resources.getClass()</span><br><span class="line">                    .getMethod(<span class="string">"updateConfiguration"</span>, Configuration<span class="class">.<span class="keyword">class</span>, <span class="title">DisplayMetrics</span>.<span class="title">class</span>)</span>;</span><br><span class="line">            Configuration configuration = <span class="keyword">new</span> Configuration(resources.getConfiguration());</span><br><span class="line">            DisplayMetrics displayMetrics = resources.getDisplayMetrics();</span><br><span class="line">            configuration.orientation = Configuration.ORIENTATION_LANDSCAPE;</span><br><span class="line">            updateConfiguration.invoke(resources, configuration, displayMetrics);</span><br><span class="line">            callback.onLoad(context, resources);</span><br><span class="line">            configuration.orientation = Configuration.ORIENTATION_PORTRAIT;</span><br><span class="line">            updateConfiguration.invoke(resources, resources.getConfiguration(), displayMetrics);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception error) &#123;</span><br><span class="line">            error.printStackTrace();</span><br><span class="line">            callback.onLoad(context, resources);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onLoad</span><span class="params">(Context context, Resources resources)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ã€€ã€€æœ€è¿‘åœ¨åš &lt;a href=&quot;http://www.bigo.sg/index_pc.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Bigo Live&lt;/a&gt; ç›´æ’­é—´çš„æ¨ªå±é€‚é…ï¼Œæ¨ªå±å’Œç«–å±ä¸‹ä¼šæœ‰ä¸€äº›çŠ¶æ€çš„å·®å¼‚ã€‚ä½†æˆ‘ä»¬çš„åº”ç”¨åœ¨æ¨ªå±ä¸‹ï¼Œåˆ‡æ¢åå°å†å›æ¥åï¼Œå‘ç°ä¸€äº›çŠ¶æ€æ˜¾ç¤ºä¸å¯¹ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="è¸©å‘" scheme="http://linroid.com/tags/%E8%B8%A9%E5%9D%91/"/>
    
  </entry>
  
  <entry>
    <title>æ­¤æ–‡çŒ®ç»™æˆ‘çš„å¼ºè¿«ç—‡</title>
    <link href="http://linroid.com/2016/08/31/Obsessive-compulsive-disorder/"/>
    <id>http://linroid.com/2016/08/31/Obsessive-compulsive-disorder/</id>
    <published>2016-08-31T03:30:05.000Z</published>
    <updated>2019-12-21T15:53:13.849Z</updated>
    
    <content type="html"><![CDATA[<p>ã€€ã€€æœ€è¿‘åˆæƒ³æ‹¾èµ·è’åºŸå·²ä¹…çš„åšå®¢äº†ï¼Œç¿»äº†ä¸‹ä¹‹å‰å†™çš„ï¼Œçœ‹åˆ°ä¸­è‹±æ–‡ä¸ç©ºæ ¼ã€ä¸­è‹±æ–‡ç¬¦å·æºæ‚è¿™äº›å¾ˆéš¾å¿å—ï¼Œäºæ˜¯é»˜é»˜å¼€å§‹ä¿®æ”¹â€¦</p><p>ã€€ã€€æˆ‘ä¹Ÿæœ‰ä¸€äº›å…¶ä»–å¼ºè¿«ç—‡ï¼Œæ¯”å¦‚ä»£ç ä¸­çš„ç©ºæ ¼ï¼ˆæ³¨é‡Šä¹Ÿä¸æ”¾è¿‡ï¼‰ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€ä¼šéµè¡Œä¸åŒçš„ä»£ç é£æ ¼ã€‚ä¸€éƒ¨åˆ†å¼ºè¿«ç—‡è¢«å¼ºè¡Œæ‰³æ­£ï¼Œæ¯”å¦‚åº”ç”¨é‡Œçš„å°çº¢ç‚¹ï¼ˆå½“ç„¶ï¼Œå¶å°”è¿˜æ˜¯ä¼šæ¸…ç©ºä¸€ä¸‹=ã€‚=ï¼‰ï¼›ä¸€éƒ¨åˆ†å¼ºè¿«ç—‡æ˜¯å—å…¶ä»–äººå½±å“ï¼Œæ¯”å¦‚ä¸­è‹±æ–‡è¦ç©ºæ ¼æ˜¯åœ¨çŸ¥ä¹é‡Œå…»æˆçš„ã€‚</p><p>ã€€ã€€æœ‰çš„å¼ºè¿«ç—‡å°±è·Ÿä¿¡ä»°ä¸€æ ·ï¼Œä¸å®¹å†’çŠ¯ï¼Œæ—¶åˆ»çº¦æŸç€è‡ªå·±å†™å‡ºæ›´ã€ä¼˜é›…ã€çš„ä»£ç ã€‚æœ‰çš„å¼ºè¿«ç—‡å°±æ˜¯è‡ªå·±ä½œæ­»ï¼Œå¿ƒç†ä¼šæš—ç¤ºè‡ªå·±å»å…‹æœã€‚</p><p>ã€€ã€€æ„¿æ‰€æœ‰å¼ºè¿«ç—‡æ‚£è€…å®‰å¥½:)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ã€€ã€€æœ€è¿‘åˆæƒ³æ‹¾èµ·è’åºŸå·²ä¹…çš„åšå®¢äº†ï¼Œç¿»äº†ä¸‹ä¹‹å‰å†™çš„ï¼Œçœ‹åˆ°ä¸­è‹±æ–‡ä¸ç©ºæ ¼ã€ä¸­è‹±æ–‡ç¬¦å·æºæ‚è¿™äº›å¾ˆéš¾å¿å—ï¼Œäºæ˜¯é»˜é»˜å¼€å§‹ä¿®æ”¹â€¦&lt;/p&gt;
&lt;p&gt;ã€€ã€€æˆ‘ä¹Ÿæœ‰ä¸€äº›å…¶ä»–å¼ºè¿«ç—‡ï¼Œæ¯”å¦‚ä»£ç ä¸­çš„ç©ºæ ¼ï¼ˆæ³¨é‡Šä¹Ÿä¸æ”¾è¿‡ï¼‰ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€ä¼šéµè¡Œä¸åŒçš„ä»£ç é£æ ¼ã€‚ä¸€éƒ¨åˆ†å¼ºè¿«ç—‡è¢«å¼ºè¡Œæ‰³æ­£ï¼Œæ¯”å¦‚åº”ç”¨é‡Œçš„å°çº¢ç‚¹ï¼ˆå½“ç„¶ï¼Œ
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>è®¾ç½®ç•Œé¢ä¸­ SwitchCompat æ— åŠ¨ç”»æ•ˆæœ</title>
    <link href="http://linroid.com/2016/02/26/SwitchCompat-s-animation-not-work-in-Preference/"/>
    <id>http://linroid.com/2016/02/26/SwitchCompat-s-animation-not-work-in-Preference/</id>
    <published>2016-02-26T05:48:27.000Z</published>
    <updated>2019-12-21T15:53:13.851Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p> Support library çš„ <code>SwitchCompat.java</code> :<br> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setChecked</span><span class="params">(<span class="keyword">boolean</span> checked)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.setChecked(checked);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calling the super method may result in setChecked() getting called</span></span><br><span class="line">    <span class="comment">// recursively with a different value, so load the REAL value...</span></span><br><span class="line">    checked = isChecked();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (getWindowToken() != <span class="keyword">null</span> &amp;&amp; ViewCompat.isLaidOut(<span class="keyword">this</span>) &amp;&amp; isShown()) &#123;</span><br><span class="line">        animateThumbToCheckedState(checked);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Immediately move the thumb to the new position.</span></span><br><span class="line">        cancelPositionAnimator();</span><br><span class="line">        setThumbPosition(checked ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><a id="more"></a><p> Framework çš„ <code>Switch.java</code><br> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setChecked</span><span class="params">(<span class="keyword">boolean</span> checked)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.setChecked(checked);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calling the super method may result in setChecked() getting called</span></span><br><span class="line">    <span class="comment">// recursively with a different value, so load the REAL value...</span></span><br><span class="line">    checked = isChecked();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isAttachedToWindow() &amp;&amp; isLaidOut()) &#123;</span><br><span class="line">        animateThumbToCheckedState(checked);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Immediately move the thumb to the new position.</span></span><br><span class="line">        cancelPositionAnimator();</span><br><span class="line">        setThumbPosition(checked ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p> å¯ä»¥çœ‹åˆ° SwitchCompat å¤šäº†ä¸€ä¸ª <code>isShown()</code> çš„åˆ¤å®šæ¡ä»¶</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the visibility of this view and all of its ancestors</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> True if this view and all of its ancestors are &#123;<span class="doctag">@link</span> #VISIBLE&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isShown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    View current = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">//noinspection ConstantConditions</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ((current.mViewFlags &amp; VISIBILITY_MASK) != VISIBLE) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ViewParent parent = current.mParent;</span><br><span class="line">        <span class="keyword">if</span> (parent == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// We are not attached to the view root</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!(parent <span class="keyword">instanceof</span> View)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = (View) parent;</span><br><span class="line">    &#125; <span class="keyword">while</span> (current != <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>isShown()</code> ä¼šå‘ä¸Šé€’å½’ï¼Œå¦‚æœ parent ä¸º null å°±è¿”å› falseã€‚<br>è€Œ Preference ä¸­ï¼Œå¦‚æœç‚¹å‡»äº†ï¼Œå°±ä¼šè°ƒç”¨ <code>notifyDataSetChanged()</code> åˆ·æ–°æ•´ä¸ª RecyclerViewï¼ŒSwitchCompat çš„ <code>setChecked()</code> æ˜¯åœ¨ <code>onBindViewHolder</code> æ—¶è°ƒç”¨çš„ï¼Œè¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰æ·»åŠ åˆ° parent ä¸­ï¼Œæ‰€ä»¥ <code>isShown()</code> å°±ä¼š return falseï¼Œä»è€ŒåŠ¨ç”»ä¸æ‰§è¡Œã€‚</p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>  å› ä¸º Preference çš„ç‰¹æ®Šæ€§ï¼Œæ‰€æœ‰çŠ¶æ€æ”¹å˜éƒ½é€šè¿‡ <code>notifyDataSetChanged()</code> æ¥ç”Ÿæ•ˆï¼Œæ‰€ä»¥è¿™é‡Œé€šè¿‡ä»¥ä¸‹ hack çš„æ–¹å¼æ¥è§£å†³ï¼Œå…¶ä»–åœ°æ–¹ä½¿ç”¨åˆ° <code>SwitchCompat</code>ç«‹å³ setChecked() å°±ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜</p><p>  åˆ›å»º <code>SwitchCompatFixed</code>ç»§æ‰¿ SwitchCompat é‡å†™<code>isShown()</code>æ–¹æ³•<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isShown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">ViewParent parent = getParent();</span><br><span class="line"><span class="keyword">if</span> (parent != <span class="keyword">null</span> &amp;&amp; parent <span class="keyword">instanceof</span> ViewGroup) &#123;</span><br><span class="line">ViewGroup widgetFrame = (ViewGroup) parent;</span><br><span class="line"><span class="keyword">if</span> (widgetFrame.getId() == android.R.id.widget_frame) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">super</span>.isShown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>   ä¸»é¢˜ä¸­ä¿®æ”¹ SwitchPreferenceCompat çš„æ ·å¼<br>   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"switchPreferenceCompatStyle"</span>&gt;</span>@style/Preference.SwitchPreferenceCompatFixed<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>   å®šä¹‰æ ·å¼<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"Preference.SwitchPreferenceCompatFixed"</span> <span class="attr">parent</span>=<span class="string">"Preference.SwitchPreferenceCompat"</span>&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:layout"</span>&gt;</span>@layout/preference_material<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:widgetLayout"</span>&gt;</span>@layout/preference_widget_switch_fixed<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>åˆ›å»ºå¸ƒå±€æ–‡ä»¶<code>preference_widget_switch_fixed.xml</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.SwitchCompat</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/switchWidget"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:focusable</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:clickable</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@null"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é—®é¢˜åˆ†æ&quot;&gt;&lt;a href=&quot;#é—®é¢˜åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜åˆ†æ&quot;&gt;&lt;/a&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;&lt;p&gt; Support library çš„ &lt;code&gt;SwitchCompat.java&lt;/code&gt; :&lt;br&gt; &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setChecked&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; checked)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.setChecked(checked);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Calling the super method may result in setChecked() getting called&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// recursively with a different value, so load the REAL value...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    checked = isChecked();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (getWindowToken() != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; ViewCompat.isLaidOut(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;) &amp;amp;&amp;amp; isShown()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        animateThumbToCheckedState(checked);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// Immediately move the thumb to the new position.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cancelPositionAnimator();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setThumbPosition(checked ? &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="é‡è¿‡çš„å‘" scheme="http://linroid.com/categories/%E9%81%87%E8%BF%87%E7%9A%84%E5%9D%91/"/>
    
    
  </entry>
  
  <entry>
    <title>xip.io + gradle åœ¨è°ƒè¯•æ—¶åŠ¨æ€è®¾ç½®æœåŠ¡ç«¯åœ°å€</title>
    <link href="http://linroid.com/2015/07/24/dynamic-endpoint-when-debug-by-xip-io-and-gradle/"/>
    <id>http://linroid.com/2015/07/24/dynamic-endpoint-when-debug-by-xip-io-and-gradle/</id>
    <published>2015-07-24T11:25:55.000Z</published>
    <updated>2019-12-21T15:53:13.851Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¦‚æœæœåŠ¡ç«¯åœ¨æœ¬åœ°ï¼Œé€šå¸¸å¯é€šè¿‡æ”¹hostsã€å†™æ­»IPã€åŠ¨æ€åŸŸåç­‰æ–¹å¼æ¥è®¾ç½®æœåŠ¡ç«¯åœ°å€ï¼Œä½†æ€»è§‰å¾ˆéº»çƒ¦ï¼Œä¸çµæ´»ï¼›æ¯”å¦‚æ›´æ¢ç½‘ç»œå¯¼è‡´IPå˜åŒ–ï¼Œå°±å¾—é‡æ–°è®¾ç½®ã€‚<br>ä»Šå¤©çªç„¶æƒ³åˆ°ï¼Œåˆ©ç”¨xip.io å’Œ gradleæ¥è‡ªåŠ¨è®¾ç½®æœåŠ¡ç«¯åœ°å€</p></blockquote><a id="more"></a><p> <a href="http://xip.io" target="_blank" rel="noopener">xip.io</a> æ˜¯ä¸€ä¸ªç›´æ¥ä½¿ç”¨åŸŸåæ¥æŒ‡å®š IP çš„åŸŸåæœåŠ¡ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½® DNSï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦ä»»ä½•æ³¨å†Œã€‚è¿™è§£å†³äº†ä½¿ç”¨ IP æ— æ³•ä½¿ç”¨å¤šä¸ª Virtual Host è€Œä½¿ç”¨åŸŸååˆå¾—å¾ˆéº»çƒ¦æ”¹åœ°DNSçš„é—®é¢˜ã€‚</p><p> xip.io æ”¯æŒ <code>{custom_prefix}.{host_ip}.xip.io</code> çš„åŸŸåæ ¼å¼ï¼Œè§£æå‡ºæ¥çš„ ip å°±æ˜¯ {host_id}ã€‚å¦‚:</p><p> <code>exmple.com.127.0.0.1.xip.ip</code> ä¼šè§£æä¸º<code>127.0.0.1</code></p><p> ä¸‹é¢è¿›è¡Œ gradle é…ç½®:</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> buildTypes &#123;</span><br><span class="line">  debug &#123;</span><br><span class="line">    //...</span><br><span class="line">    def hostIp = InetAddress.getLocalHost().getHostAddress()</span><br><span class="line">    buildConfigField &quot;String&quot;, &quot;ENDPOINT&quot;, &quot;\&quot;http://example.com.$&#123;hostIp&#125;.xip.io/api\&quot;&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  release &#123;</span><br><span class="line">//...</span><br><span class="line">    buildConfigField &quot;String&quot;, &quot;ENDPOINT&quot;, &quot;\&quot;http://example.com/api\&quot;&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> åœ¨ debug ä¸‹ï¼Œgradle ä¼šè·å–å½“å‰ç”µè„‘çš„ IPï¼Œç„¶åå†™å…¥åˆ° BuildConfig ç±»ä¸­çš„ <code>ENDPOINT</code> å±æ€§ã€‚gradle sync ä¸€ä¸‹åï¼Œ<code>BuildConfig.ENDPOINT</code> å°±è¢«èµ‹å€¼ä¸º <code>http://example.com.${hostIp}.xip.io/api</code></p><p> å½“ç„¶ï¼Œè¿˜å¯ä»¥æ”¾åˆ° xml æ–‡ä»¶ä¸­:)</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resValue &quot;string&quot;, &quot;host_url&quot;, &quot;http://example.com.$&#123;hostIp&#125;.xip.io&quot;;</span><br></pre></td></tr></table></figure><p> æœ€åè®°å¾—åœ¨ apache/nginx ç­‰é…ç½® Virtual Host æ—¶ä½¿ç”¨å®½åŸŸåï¼Œå¦‚ Nginx ä¸­:</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server_name example.com.*</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¦‚æœæœåŠ¡ç«¯åœ¨æœ¬åœ°ï¼Œé€šå¸¸å¯é€šè¿‡æ”¹hostsã€å†™æ­»IPã€åŠ¨æ€åŸŸåç­‰æ–¹å¼æ¥è®¾ç½®æœåŠ¡ç«¯åœ°å€ï¼Œä½†æ€»è§‰å¾ˆéº»çƒ¦ï¼Œä¸çµæ´»ï¼›æ¯”å¦‚æ›´æ¢ç½‘ç»œå¯¼è‡´IPå˜åŒ–ï¼Œå°±å¾—é‡æ–°è®¾ç½®ã€‚&lt;br&gt;ä»Šå¤©çªç„¶æƒ³åˆ°ï¼Œåˆ©ç”¨xip.io å’Œ gradleæ¥è‡ªåŠ¨è®¾ç½®æœåŠ¡ç«¯åœ°å€&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="Android Studio" scheme="http://linroid.com/tags/Android-Studio/"/>
    
      <category term="gradle" scheme="http://linroid.com/tags/gradle/"/>
    
  </entry>
  
  <entry>
    <title>Git åœ¨ OSX ä¸­çš„æäº¤å¿½ç•¥æ–‡ä»¶åç§°å¤§å°å†™</title>
    <link href="http://linroid.com/2015/07/18/git-ignorecase/"/>
    <id>http://linroid.com/2015/07/18/git-ignorecase/</id>
    <published>2015-07-18T15:21:20.000Z</published>
    <updated>2019-12-21T15:56:22.030Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7u2rtn.com1.z0.glb.clouddn.com/Snip20150718_8.png" alt="image"><br>çœ‹åˆ°<a href="https://github.com/drakeet" target="_blank" rel="noopener">drakeet</a>çš„<a href="https://github.com/drakeet/Meizhi" target="_blank" rel="noopener">å¦¹çº¸</a> Appï¼Œæƒ³å†™ä¸ª iOS ç‰ˆæ‹¿æ¥ç»ƒæ‰‹ã€‚å¼€å§‹æ—¶é¡¹ç›®å‘½åä¸º <code>MeiZhi</code>ï¼Œç„¶åå‘ç°drakeetçš„æ˜¯<code>Meizhi</code>ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ”¹ä¸º<code>Meizhi</code>æ¥ä¿æŒä¸€è‡´ã€‚åœ¨ GitHub ä¸ŠæŸ¥çœ‹æ—¶å‘ç°åç§°å¹¶æ²¡æœ‰æ”¹å˜ï¼ŒåŸå› æ˜¯gité»˜è®¤å¿½ç•¥äº†å¤§å°å†™ã€‚<br><a id="more"></a><br>è®¾ç½® git å¤§å°å†™æ•æ„Ÿ:</p><p><code>git config core.ignorecase false</code></p><p>pushåï¼Œåœ¨GitHubä¸ŠæŸ¥çœ‹ï¼Œå‘ç°<code>Meizhi</code>å’Œ<code>MeiZhi</code>ç­‰éƒ½åŒæ—¶å­˜åœ¨ï¼Œè€Œè‡ªå·±åœ¨æœ¬åœ° ls å¹¶æ²¡æœ‰å¼‚å¸¸ã€‚OSX çš„æ–‡ä»¶åå¤§å°å†™ä¸æ•æ„Ÿä½†å¤§å°å†™ä¿ç•™ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰éƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p><strong>è§£å†³</strong>:</p><p><img src="http://7u2rtn.com1.z0.glb.clouddn.com/Snip20150718_5.png" alt="image"><br>ssh åˆ° vps ä¸Šï¼Œclone ä»£ç ï¼Œç„¶ååˆ é™¤é‡å¤çš„æ–‡ä»¶ï¼Œå† push åˆ° GitHubã€‚<br><img src="http://7u2rtn.com1.z0.glb.clouddn.com/Snip20150718_7.png" alt="image"><br>æœ¬åœ° pull åï¼Œ<code>Meizhi</code> ç›®å½•ä¹Ÿä¸å­˜åœ¨äº†ï¼Œ<code>git status</code> æŸ¥çœ‹ï¼Œæ˜¾ç¤ºè¢«åˆ é™¤ï¼Œä½¿ç”¨ <code>git reset ./</code> æ¥æ¢å¤</p><p>ä¹‹åå¦‚æœå†é‡åˆ°åªä¿®æ”¹å­—æ¯å¤§å°æ—¶å¯ä»¥é€šè¿‡ <code>git mv --force FileName Filename</code> æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7u2rtn.com1.z0.glb.clouddn.com/Snip20150718_8.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;çœ‹åˆ°&lt;a href=&quot;https://github.com/drakeet&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;drakeet&lt;/a&gt;çš„&lt;a href=&quot;https://github.com/drakeet/Meizhi&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¦¹çº¸&lt;/a&gt; Appï¼Œæƒ³å†™ä¸ª iOS ç‰ˆæ‹¿æ¥ç»ƒæ‰‹ã€‚å¼€å§‹æ—¶é¡¹ç›®å‘½åä¸º &lt;code&gt;MeiZhi&lt;/code&gt;ï¼Œç„¶åå‘ç°drakeetçš„æ˜¯&lt;code&gt;Meizhi&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ”¹ä¸º&lt;code&gt;Meizhi&lt;/code&gt;æ¥ä¿æŒä¸€è‡´ã€‚åœ¨ GitHub ä¸ŠæŸ¥çœ‹æ—¶å‘ç°åç§°å¹¶æ²¡æœ‰æ”¹å˜ï¼ŒåŸå› æ˜¯gité»˜è®¤å¿½ç•¥äº†å¤§å°å†™ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="é‡è¿‡çš„å‘" scheme="http://linroid.com/categories/%E9%81%87%E8%BF%87%E7%9A%84%E5%9D%91/"/>
    
    
      <category term="git" scheme="http://linroid.com/tags/git/"/>
    
      <category term="OSX" scheme="http://linroid.com/tags/OSX/"/>
    
  </entry>
  
  <entry>
    <title>æ‰¾å®ä¹ çš„é‚£ç‚¹äº‹</title>
    <link href="http://linroid.com/2015/05/22/Internship-interview/"/>
    <id>http://linroid.com/2015/05/22/Internship-interview/</id>
    <published>2015-05-22T09:15:27.000Z</published>
    <updated>2019-12-21T15:56:22.030Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7u2rtn.com1.z0.glb.clouddn.com/IMG20150507154554.jpg" alt="é˜¿é‡ŒåŒ…åŒ…~"><br>  æ‹–å»¶ç—‡æ™šæœŸï¼Œæ‰€ä»¥ç°åœ¨æ‰æ‰¾åˆ°å·²é—²ç½®å¾ˆä¹…çš„åšå®¢ï¼ŒæŠŠè‡ªå·±æ‰¾å®ä¹ çš„è¿‡ç¨‹å†™ä¸‹æ¥( hexo éƒ½æ›´æ–°ä¸€ä¸ªç‰ˆæœ¬å·äº†:)<br><a id="more"></a><br>  å»å¹´æš‘å‡æ—¶å‡ºå»å®ä¹ è¿‡ä¸¤ä¸ªæœˆï¼Œä¸è¿‡é‚£æ˜¯é€šè¿‡è€å¸ˆè®¤è¯†çš„ä¸€ä¸ªäººï¼Œç›´æ¥å»çš„ï¼Œç»“æœè¢«å‘å¾—å·¨æƒ¨ï¼Œè¿™æ¬¡å¤§ä¸‰ï¼Œè¦è®¤çœŸçš„æ‰¾ä¸€å®¶è‡ªå·±æƒ³å»çš„å…¬å¸äº†ã€‚</p><p>å¯’å‡æ—¶å‚è€ƒç€ <a href="https://github.com/geekcompany/ResumeSample/blob/master/android.md" target="_blank" rel="noopener">Androidç¨‹åºå‘˜ç®€å†æ¨¡æ¿</a> å¼€å§‹å†™è‡ªå·±çš„ç®€å†ï¼Œ3.3æ—¥æ”¶åˆ°ä¸‰ç¿¼çš„è€äººè‚–å½¬å­¦é•¿çš„é˜¿é‡Œå·´å·´å†…æ¨é‚®ä»¶ï¼Œç”±æ­¤è¿›å…¥äº†æ‰¾å®ä¹ çš„è‹¦é€¼æ—¥å­ã€‚ç®€å†é€šè¿‡ï¼Œè¿›å…¥å†…æ¨çš„ç”µè¯é¢è¯•é˜¶æ®µï¼Œå½“æ—¶å¾ˆé«˜å…´çš„è¿˜æˆªå›¾å‘äº†æœ‹å‹åœˆï¼Œç»“æœä½œä¸ºå¤„å¥³é¢ï¼Œè¢«é¢è¯•å®˜å®Œè™ï¼Œè¿™é‡Œä¸å¾—ä¸æ„Ÿå¹ä¸‹é˜¿é‡Œæ‹›è˜ç³»ç»Ÿçš„æ•ˆç‡ï¼ŒæŒ‚å®Œç”µè¯åå¤šåˆ†é’Ÿå°±å‡ºé¢è¯•ç»“æœï¼Œè¿…é€Ÿæ³¯ç­äº†è‡ªå·±çš„ä¾¥å¹¸å¿ƒç†ã€‚</p><p>  é¢è¯•å¤±è´¥çš„æŒ«è´¥æ„Ÿè®©è‡ªå·±å¼€å§‹åæ€ï¼Œæœäº†ä¸€äº›é¢ç»ï¼Œçœ‹åˆ°ä¸€å¥è¯: <code>ç»éªŒå¹¶ä¸èƒ½ä»£è¡¨èƒ½åŠ›</code>ã€‚çœ‹ç€è‡ªå·±ç®€å†ä¸Šçš„é¡¹ç›®ç»å†ï¼ŒæŒºå¤šã€‚ç„¶è€Œè‡ªå·±é¢è¯•æ—¶å€™è¿å¤§ç«¯ã€å°ç«¯è¿™æ ·çš„åŸºç¡€é—®é¢˜éƒ½æ²¡å›ç­”ä¸Šæ¥ï¼Œæ·±æ„Ÿè‡ªå·±å°±æ˜¯ä¼ è¯´ä¸­çš„â€œç å†œâ€ã€‚äºæ˜¯å¼€å§‹è¡¥åŸºç¡€ï¼Œä¸èƒ½è®©è‡ªå·±è¾“çš„å¤ªæƒ¨ã€‚çœ‹äº†ä»¥ä¸‹çš„å‡ æœ¬ä¹¦ï¼š</p><ul><li>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹</li><li>ã€Šç®—æ³•å¯¼è®ºã€‹</li><li>ã€Šç®—æ³•ã€‹</li><li>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹</li><li>ã€Šç°ä»£æ“ä½œç³»ç»Ÿã€‹</li></ul><p> å¸¦ç€ç›®çš„æŒ‘äº†ä¸€äº›è§‰å¾—å¯èƒ½é¢è¯•ä¼šé—®åˆ°çš„å†…å®¹çœ‹(ä»Šåä¸€å®šè¦è®¤çœŸå•ƒå®Œè¿™äº›ä¹¦ï¼ä¸€å®šï¼ï¼ï¼)ã€‚</p><p> é‚£æ®µæ—¶é—´ï¼ŒçŸ¥ä¹<a href="http://www.zhihu.com/people/fkysly" target="_blank" rel="noopener">é©¬å¤©ç¿¼</a>åˆšæ‹¿åˆ°é˜¿é‡Œçš„å®ä¹  offerï¼Œæ­£åœ¨ä»–å»ºçš„ç¾¤é‡Œå¸® winter å¤§å¤§æ‹›å®ä¹ ç”Ÿï¼ŒåŒå­¦çœ‹åˆ°åå‘ä»–å¹äº†æˆ‘å‡ å¥ï¼Œç„¶åè®©æˆ‘è”ç³»ä»–ã€‚å‘äº†ç®€å†åï¼Œè‚¯å®šäº†æˆ‘å‡ å¥ï¼Œè¯´ä¸€å®šèƒ½è¿›é˜¿é‡Œï¼Œå¹¶æŠŠç®€å†è½¬äº¤ç»™ winter äº†ã€‚å‡ å¤©åè¶´åœ¨æ•™å®¤åº§ä½ç†Ÿç¡æ—¶ï¼Œæ¥åˆ°å¦ä¸€ä½å·¥ç¨‹å¸ˆçš„ç”µé¢ï¼Œè¿™æ¬¡çš„æ„Ÿè§‰è¯­æ°”è½»å¤šäº†ï¼Œé—®çš„é—®é¢˜å¦‚ Android æ¶æ„åˆ†å±‚çš„å¥½å¤„ã€Retrofit çš„ç¼ºç‚¹å¦‚æœè®©æˆ‘è®¾è®¡ä¼šæ€æ ·è®¾è®¡ï¼ŒèŠäº†èŠå¼€æºçš„ä¸œè¥¿ã€‚æœ€åå› ä¸ºè¿‡äº†å†…æ¨æ—¶é—´ï¼Œä»–è®©æˆ‘å†å‚åŠ æ­£å¸¸çš„å®ä¹ ç”Ÿæ ¡æ‹›æµç¨‹ï¼Œäºæ˜¯è¿›å…¥é˜¿é‡Œæ ¡æ‹›å®˜ç½‘å†æ¬¡æŠ•é€’â€¦</p><p> æ¥ç€æŠ•äº†è±†ç“£ï¼Œç¬”è¯•é¢˜å¾ˆç®€å•ï¼Œä¸¤é“ç®—æ³•äºŒé€‰ä¸€ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯ Android åŸºç¡€é—®é¢˜,é¢˜ç›®æœ‰äº›å¤šï¼Œ1ä¸ªå°æ—¶ç­”é¢˜æ—¶é—´ï¼Œæœ€åæ²¡åšå®Œã€‚</p><p> æŸå¤©å¿ƒè¡€æ¥æ½®ï¼Œåšç€è„¸çš®ï¼ŒQQ ä¸Šæ‰¾ <a href="http://weibo.com/issacsuixing" target="_blank" rel="noopener">@ç¢ç¢iKe</a> è¦äº†è±Œè±†èšå’Œå°ç±³çš„æ¨èã€‚è±Œè±†èšå¾ˆé€Ÿåº¦ï¼ŒHRéš”å¤©å°±è”ç³»æˆ‘é¢„çº¦äº†ç”µé¢æ—¶é—´ã€‚è±Œè±†èšçš„ç”µé¢æ¯è½®ä¸€å°æ—¶å·¦å³ï¼Œéƒ½æœ‰åœ¨çº¿ coding é˜¶æ®µ(é€šè¿‡ <a href="http://collabedit.com/" target="_blank" rel="noopener">collabedit</a> è¿™ä¸ªç½‘ç«™)ã€‚è¿‡äº†ä¸‰æ¬¡ç”µé¢ï¼Œéœ€è¦æˆ‘å»åŒ—äº¬ç°åœºå‚åŠ é¢è¯• ( æŠ¥é”€æ¥å¾€é«˜é“ç¥¨å’Œä¸€æ™šçš„ä½å®¿è´¹å¥½è¯„ï¼)ã€‚</p><p> å»åŒ—äº¬ä¹‹å‰è¿›è¡Œäº†è±†ç“£çš„ç”µé¢ï¼Œé—®çš„éƒ½æ˜¯ Android æ–¹é¢çš„å†…å®¹ï¼Œå›ç­”çš„å¾ˆé¡ºç•…ã€‚</p><p> æå‰æ¥åˆ°è´µèšå…¬å¸é™„è¿‘ï¼Œè¢«å‘¨å›´çš„ç¯å¢ƒæƒŠè‰³åˆ°äº†ï¼Œå¯ä»¥ç§’æ€å¾ˆå¤šå…¬å›­ï¼Œè®©æˆ‘å¯¹è´µèšæ›´åŠ å‘å¾€äº†ã€‚ç°åœºé¢çš„ç¬¬ä¸€è½®æ˜¯ä½å§å§ï¼Œé¢è¯•è¿‡ç¨‹å°±è·Ÿæ™®é€šèŠå¤©ä¸€æ ·ï¼Œè¿˜è¡¨æ‰¬äº†æˆ‘UIæ–¹é¢çš„çŸ¥è¯†ã€‚ç¬¬äºŒè½®çš„é¢è¯•å®˜ä¸€ä¸Šæ¥å°±è®©åœ¨çº¸ä¸Šå†™ä»£ç ï¼Œéƒ½ä¸çŸ¥é“è‡ªå·±å½“æ—¶å“ªæ¥çš„è‡ªä¿¡å†™å®Œæ²¡æ£€æŸ¥å°±ç»™ä»–çœ‹äº†ï¼Œç»“æœæ¼æ´ç™¾å‡º=_=ï¼Œç„¶åå…¨ç¨‹ç´§å¼ ï¼Œé—®çš„æ€ç»´é¢˜å®Œå…¨æ²¡æ€è·¯ã€‚<br>  <img src="http://7u2rtn.com1.z0.glb.clouddn.com/IMG_20150419_082209.jpg" alt="ä¸€ä¸ªäººçé€›"><br>  <img src="http://7u2rtn.com1.z0.glb.clouddn.com/IMG_20150418_145928.jpg" alt="ä¸åˆ°é•¿åŸéå¥½æ±‰"><br> åœ¨åŒ—äº¬æµªäº†ä¸¤å¤©ä¸€ä¸ªäººçˆ¬äº†é•¿åŸã€çœ‹äº†é€Ÿ7ï¼Œåé«˜é“å›å­¦æ ¡çš„é€”ä¸­é€šè¿‡äº‘æ‹›æ±‚èŒçš„å¾®ä¿¡å·æŸ¥åˆ°äº†è‡ªå·±çš„é¢è¯•ç»“æœï¼šå·²æ‹’ç»ã€‚å½“æ—¶æ„Ÿè§‰æ¯”å¤±æ‹è¿˜éš¾å—ï¼Œå¾ˆå—æ‰“å‡»ã€‚</p><p> å›åˆ°å­¦æ ¡åï¼Œä¸æƒ³çœ‹ä¹¦ï¼Œç©äº†å‡ å¤©æ¸¸æˆï¼Œæƒ³æƒ³æŒ‚åœ¨ç¬¬äº”é¢å°±å¿ƒç´¯â€¦</p><p> ç„¶åQQçªç„¶æ”¶åˆ°å°ç±³HRçš„åŠ å¥½å‹è¯·æ±‚ï¼Œéƒ½ä¸€ä¸ªæœˆäº†å•Šï¼Œæ‰è”ç³»æˆ‘=_=äºæ˜¯åˆè¢«å°ç±³çš„å·¥ç¨‹å¸ˆè¿›è¡Œç”µé¢ï¼Œé‚£ä¸ªé¢è¯•å®˜æ„Ÿè§‰æ°´å¹³å¾ˆä¸€èˆ¬ï¼Œå‡ ä¸ªé—®é¢˜éƒ½æ˜¯é—®æˆ‘æ—¶â€œxx ä¼šä¸ä¼šâ€ï¼Œæˆ‘è¯´ä¼šï¼Œå¹¶ä¸”è¿›è¡Œäº†ä¸€äº›è¯´æ˜ï¼Œå¹¶æ²¡æœ‰è¿½é—®æˆ‘å…¶ä»–çš„ï¼Œé—®çš„é—®é¢˜éƒ½æ˜¯éå¸¸åŸºç¡€çš„ä¸œè¥¿ã€‚</p><p> æœ‰æ„æ€çš„æ˜¯æŸå¤©ç©æ— ç§˜æ—¶ï¼Œåœ¨è‡ªå·±åŠ çš„ä¸€ä¸ª BAT çš„ç¾¤é‡Œé—®äº†ä¸‹æœ‰è°è¦å®ä¹ ç”Ÿä¸ï¼Œç»“æœçœŸæœ‰ä¸€ä¸ªäººç§èŠäº†æˆ‘ï¼ŒåŠ äº†å¾®ä¿¡ï¼Œç„¶åè®©æˆ‘å‘æŠŠç®€å†å‘åˆ° emailï¼Œæ ¹æ® email çŸ¥é“ä»–å±…ç„¶æ˜¯æ–°ç¾äº’é€šçš„ä¸€ä¸ªè”åˆåˆ›å§‹äºº(æœ¬åªæ˜¯ä¸ªå¤–åŒ…å…¬å¸çš„,æ–°ç¾äº’é€šçš„äº§å“æœ‰å‡ äº¿ç”¨æˆ·å‘¢ï¼Œä¸»è¦åšæµ·å¤–å¸‚åœºï¼ŒAndroid ä¸Šçš„å­—ä½“ç®¡å®¶å°±æ˜¯ä»–ä»¬åšçš„ï¼Œè¿˜æœ‰ä¸€ä¸ªè¾“å…¥æ³•åœ¨ play å·¥å…·å…è´¹æ¦œæ’å‰å)ã€‚ç”µé¢çš„è¿‡ç¨‹ä¹Ÿæ²¡éš¾åº¦ï¼Œé—®çš„éƒ½æ˜¯ Android æ–¹é¢çš„~éšåé€šçŸ¥é€šè¿‡äº†ç”µé¢ï¼Œè®©æˆ‘å»åŒ—äº¬é¢è¯•ï¼Œåˆæ˜¯å¯ä»¥æŠ¥é”€é«˜é“å•Šï¼Œå“ˆå“ˆï¼ŒIT å…¬å¸å°±æ˜¯è´¢å¤§æ°”ç²—ã€‚</p><p>  5.3 ç¦»å¼€å­¦æ ¡å’Œä¸‰ç¿¼çš„è€å¤§ä¸€èµ·å»å¹¿å·å‚åŠ é˜¿é‡Œçš„ç°åœºé¢è¯•ï¼Œå› ä¸ºå½“æ—¶æœ‰å¯èƒ½æ‹¿åˆ°è±†ç“£ã€å°ç±³ã€æ–°ç¾äº’é€šç­‰å…¬å¸ offerï¼Œæ‰€ä»¥å¯¹è¿™æ¬¡é¢è¯•å¹¶ä¸æ˜¯ç‰¹åœ¨æ„ï¼Œå³ä½¿å¤±è´¥ï¼Œä¹Ÿåº”è¯¥æœ‰ä¸€å®¶æ”¶ç•™å§(â•¥ï¹â•¥)ï¼ˆå…¶å®æ˜¯å¥”ç€æƒ³å»é™Œç”Ÿçš„å¹¿å·è€è€çš„ï¼Œæ‰€ä»¥é¢è¯•åœ°ç‚¹é€‰æ‹©äº†æ›´è¿œçš„å¹¿å·ï¼Œå»çš„æ—¶å€™åçš„ç»¿çš®è½¦çœŸå¤ŸæŠ˜è…¾çš„â€¦ï¼‰ã€‚åœ¨é…’åº—ç­‰å¾…è¢«å‘¼å«çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜æ¥åˆ°è±†ç“£HRçš„ç”µè¯ï¼Œè¯´æˆ‘é€šè¿‡äº†é¢è¯•ï¼Œè¦ç»™æˆ‘ offerã€‚å¿ƒä¸­ä¸€é˜µç‹‚å–œå•Šï¼Œç»ˆäºæœ‰äººæ”¶ç•™äº†ï¼ï¼ï¼</p><p> <img src="http://7u2rtn.com1.z0.glb.clouddn.com/IMG_20150505_131837.jpg" alt="é˜¿é‡Œé¢è¯•ç­‰å€™åŒº"><br>  é˜¿é‡Œçš„è¿™æ¬¡é¢è¯•å¤ªå¹¸è¿äº†ï¼Œå¾ˆæ„Ÿè°¢ç¬¬ä¸€è½®çš„é¢è¯•å®˜ï¼ŒæŠŠç®€å†é€’ç»™ä»–æ—¶ï¼Œä¸€è¡Œä¸€è¡ŒæŒ‡ç€çœ‹ï¼Œæ¯ä¸ªé“¾æ¥éƒ½æ‰‹åŠ¨è¾“å…¥åˆ°ç”µè„‘æŸ¥çœ‹ã€‚åœ¨ä»–çœ‹æˆ‘ GitHub æ—¶å°±æ„Ÿè§‰æœ‰æˆäº†ï¼Œä»–çš„è¯è¯­è®©æˆ‘å¹¶æ²¡æœ‰è§‰å¾—å¾ˆç´§å¼ ï¼Œè¿˜è¯´å‘ç°æˆ‘çš„ commit å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸­åˆå’Œæ™šä¸Š,è®¤çœŸå§ï¼ï¼ï¼ä¸è¿‡æˆ‘ä¹ŸçŠ¯å‚»äº†ï¼Œé—®äº†æˆ‘ä¸€é“åˆ¤æ–­é“¾è¡¨ç¯è·¯çš„ç®—æ³•ï¼Œå› ä¸ºä¹‹å‰è±Œè±†çš„ç”µé¢è¢«é—®è¿‡ï¼Œå½“ä»–è¯´è¯´å®Œé—®é¢˜åï¼Œæˆ‘å°±ç«‹é©¬è¯´å‡ºäº†æ€è·¯ï¼Œä»–ä¹Ÿç«‹é©¬å°±æ¢é¢˜äº†=_=ç„¶åæˆ‘æ²¡åšå‡ºæ¥ï¼Œä¸è¿‡ä»–è¿å¿™è¯´æ²¡äº‹æ²¡äº‹ã€‚äºŒé¢çš„é¢è¯•å®˜é—®çš„éƒ½æ˜¯å…³äºé¡¹ç›®ç»éªŒçš„äº†ï¼Œå¾ˆè½»æ¾çš„è¿‡äº†ã€‚ä¸è¿‡åˆšå›åˆ°ç­‰å¾…å®¤å°±è¢«é€šçŸ¥è¿›è¡Œä¸‹ä¸€åœºé¢è¯•( HR é¢)ï¼Œéƒ½æ²¡æ¥å¾—åŠå–æ°´å•Š!!! é¢è¯•å®˜å§å§çœ‹å‡ºæ¥äº†ï¼Œç»™æˆ‘æ‹¿äº†æ¯æ°´ï¼Œå¤ªæ„ŸåŠ¨äº†ï¼Œå“ˆå“ˆã€‚é—®çš„é—®é¢˜ä¸ç®—åˆéš¾ï¼Œå„ä¸ªæ–¹é¢çš„é—®é¢˜éƒ½æœ‰ï¼Œè‡ªå·±å›ç­”çš„æŒºè°¨æ…ï¼Œç”Ÿæ€•å“ªä¸ªé—®é¢˜å›ç­”å¾—ä¸ HR ä¸‰è§‚ä¸ç¬¦è¢«åˆ·äº†ã€€(Â´Ğ”` )ã€‚<br> <img src="http://7u2rtn.com1.z0.glb.clouddn.com/IMG_20150507_101451.jpg" alt="åœ†æ¡Œæ²™é¾™çš„anliç°åœº"><br>  æ™šä¸Šæ”¶åˆ°çŸ­ä¿¡é€šè¿‡äº†é˜¿é‡Œé¢è¯•ï¼Œå‘æœ‹å‹åœˆç§€ä¸€ä¸‹ï¼å˜¿ã€‚ç¬¬äºŒå¤©æ—©ä¸Šåˆæ”¶åˆ°å°ç±³ HR çš„ç”µè¯ï¼Œç»™æˆ‘ offerï¼Œé—®æˆ‘å…¥èŒçš„äº‹(ä»€ä¹ˆé¬¼ï¼Œä¹‹å‰è¯´è‚¯å®šæœ‰ç°åœºé¢è¯•å•Šï¼Œç»“æœä¸€è½®å°±è®©æˆ‘è¿‡äº† =_=? çœŸæ˜¯äººå“çˆ†å‘å•Š)ã€‚è‡³æ­¤å·²ç»æœ‰äº†è±†ç“£ã€å°ç±³ã€é˜¿é‡Œçš„ offerï¼Œæœæ–­æ‹’ç»äº†æ–°ç¾çš„é¢è¯•ã€‚å‚åŠ é˜¿é‡Œçš„åœ†æ¡Œæ²™é¾™è¢« anli åï¼Œä¾¿æ‹’ç»äº†å°ç±³å’Œè±†ç“£ çš„ offerï½ã€‚</p><p>  ä»¥ä¸Šå°±æ˜¯æˆ‘æ‰¾å®ä¹ çš„æµæ°´è´¦äº†ï¼ˆæ·±æ„Ÿä¸å¦‚å°å­¦ç”Ÿä½œæ–‡æ°´å¹³ï¼Œçœ‹æ¥ä»¥åè¦å¤šç å­—äº†ï¼‰ï¼Œæ€»ç»“èµ·æ¥ï¼Œè¦é‡è§†åŸºç¡€ï¼Œä¸ç„¶ä¼šæ­»å¾—å¾ˆæƒ¨ï¼›é¢è¯•æœºä¼šæœ‰å¾ˆå¤šé€”å¾„ï¼Œè‡ªå·±å»äº‰å–ï¼Œæ¯”å¦‚æˆ‘å°±ä»æ— ç§˜æ‹¿åˆ°äº†ï¼›å†…æ¨å¯ä»¥çœå»å¾ˆå¤šéº»çƒ¦ï¼Œå¦‚æœæœ‰ä¸é”™çš„æˆå°±å¾ˆå®¹æ˜“æ‹¿åˆ°å†…æ¨ï¼Œæˆ‘å¤§æ¦‚æ˜¯é  GitHub ä¸Š700å¤šçš„ star æ‹¿çš„å†…æ¨ï¼›ä¸è¦å¤ªåœ¨æ„ä¸€åœºé¢è¯•ï¼Œæœºä¼šè¿˜æœ‰å¾ˆå¤šï¼Œå¤ªåœ¨æ„å¯èƒ½ä¼šè¿‡äºç´§å¼ å¯¼è‡´å‘æŒ¥å¤±å¸¸ï¼›å¹³æ—¶å¤šç§¯æ”’äººå“â€¦</p><p>  <strong>é™„ä¸Šä¸€äº›å¾ˆæœ‰ç”¨çš„ä¸€äº›èµ„æº:</strong></p><ul><li><p><a href="http://www.codekk.com/open-source-project-analysis" target="_blank" rel="noopener">codeKK å¼€æºé¡¹ç›®æºç åˆ†æ</a> èƒ½å¯¹æºç åˆ†æï¼Œé¢è¯•æ—¶å¯ä»¥ç»™é¢è¯•å®˜å¾ˆå¥½çš„å°è±¡~</p></li><li><p><a href="https://github.com/HIT-Alibaba/interview/wiki" target="_blank" rel="noopener">IT/äº’è”ç½‘ç¬”è¯•é¢è¯•çŸ¥è¯†æ•´ç†</a></p></li><li><p><a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html" target="_blank" rel="noopener">Data Structure Visualizations</a> æ•°æ®ç»“æ„å¯è§†åŒ–ï¼Œå¾ˆå¼å•Š!</p></li><li><p><a href="https://github.com/pedrovgs/Algorithms" target="_blank" rel="noopener">pedrovgs/Algorithms</a> å¸¸ç”¨ç®—æ³•çš„Javaå®ç°</p></li><li><p><a href="https://oj.leetcode.com/" target="_blank" rel="noopener">leetcode</a> é¢è¯•é‡åˆ°çš„ç®—æ³•é¢˜å¾ˆå¤šéƒ½åœ¨ä¸Šé¢ï¼Œç›¸æ¯”ACMçš„OJæ›´äººæ€§åŒ–ï¼›å¹³æ—¶å°±ç»ƒç»ƒï¼Œæ¯é“é¢˜å¼„é€ã€‚</p></li><li><p><a href="http://blog.csdn.net/v_july_v" target="_blank" rel="noopener">ç»“æ„ä¹‹æ³• ç®—æ³•ä¹‹é“</a> å¾ˆå¤šäººæ¨èçš„</p></li><li><a href="https://github.com/android-cn/android-discuss/issues" target="_blank" rel="noopener">android-cn/android-discuss</a>  Trinea å¤§ç‰›å»ºçš„ä¸€ä¸ªåº“ï¼Œè®¨è®ºAndroidé¢è¯•çš„ä¸€äº›é—®é¢˜^_^</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7u2rtn.com1.z0.glb.clouddn.com/IMG20150507154554.jpg&quot; alt=&quot;é˜¿é‡ŒåŒ…åŒ…~&quot;&gt;&lt;br&gt;  æ‹–å»¶ç—‡æ™šæœŸï¼Œæ‰€ä»¥ç°åœ¨æ‰æ‰¾åˆ°å·²é—²ç½®å¾ˆä¹…çš„åšå®¢ï¼ŒæŠŠè‡ªå·±æ‰¾å®ä¹ çš„è¿‡ç¨‹å†™ä¸‹æ¥( hexo éƒ½æ›´æ–°ä¸€ä¸ªç‰ˆæœ¬å·äº†:)&lt;br&gt;
    
    </summary>
    
      <category term="æ•´ç†æ€»ç»“" scheme="http://linroid.com/categories/%E6%95%B4%E7%90%86%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="å®ä¹ " scheme="http://linroid.com/tags/%E5%AE%9E%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æäº¤ library é¡¹ç›®åˆ° Maven Central</title>
    <link href="http://linroid.com/2015/03/13/upload-android-library-to-moven-central/"/>
    <id>http://linroid.com/2015/03/13/upload-android-library-to-moven-central/</id>
    <published>2015-03-13T02:51:42.000Z</published>
    <updated>2019-12-21T15:56:22.031Z</updated>
    
    <content type="html"><![CDATA[<p>  å°† <a href="http://github.com/linroid/FilterMenu" target="_blank" rel="noopener">FilterMenu</a> æäº¤åˆ° GitHub åï¼Œåœ¨ README.md çš„ Getting Started é‡Œä»…ä»…å†™ä¸Š</p><blockquote><p>Download the source to use it as library project</p></blockquote><p>  è¿™å”¯ä¸€ä½¿ç”¨é€”å¾„ï¼Œå±…ç„¶æ²¡æœ‰ gradle/maven ?ä½œä¸º Android Studio çš„å¿ å®ç”¨æˆ·ï¼Œè‡ªå·±å†™çš„åº“æ€ä¹ˆèƒ½åªæä¾›è¿™ä¹ˆéº»çƒ¦çš„æ–¹æ³•ï¼ï¼ï¼äºæ˜¯å†³å®šæŠŠå®ƒæäº¤åˆ° Maven Central ä¸­ã€‚<br><a id="more"></a></p><p>è™½ç„¶ AS çš„ gradle é»˜è®¤ä½¿ç”¨çš„æ˜¯ jcenter ä»“åº“ï¼Œä½†æˆ‘ä»¬åªéœ€è¦æäº¤åˆ° Maven Central å³å¯ï¼Œjcenter ä¼šè‡ªåŠ¨åŒæ­¥ã€‚  </p><p><strong>å¦‚æœè¿˜æ²¡æœ‰è´¦å·å…ˆå» Maven Central æ³¨å†Œ: <a href="https://issues.sonatype.org/secure/Signup!default.jspa" target="_blank" rel="noopener">Sign up</a> </strong></p><p>å¹¶åˆ° <a href="https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&amp;pid=10134" target="_blank" rel="noopener">Create Issue</a> æäº¤å·¥å•ç­‰å¾…ç®¡ç†å‘˜çš„å›å¤ï¼Œå¡« groupId æ—¶ï¼Œè¯·ä½¿ç”¨é¡¶çº§ groupIdï¼Œæ¯”å¦‚æˆ‘åªéœ€è¦å¡«å†™ <code>com.linroid</code>ï¼Œå°±å¯ä»¥å‘å¸ƒåˆ°ä»»ä½• <code>com.linroid.*</code> ä¸‹çš„groupIdã€‚</p><p>æˆ‘æ˜¯æ—©ä¸Šæäº¤çš„ï¼Œåˆ°æ™šä¸Š0:30çš„æ—¶å€™æ”¶åˆ°å›å¤ã€‚<a href="http://central.sonatype.org/articles/2014/Feb/27/why-the-wait/" target="_blank" rel="noopener">Why the wait?</a></p><blockquote><p>Configuration has been prepared, now you can:<br>Deploy snapshot artifacts into repository <a href="https://oss.sonatype.org/content/repositories/snapshots" target="_blank" rel="noopener">https://oss.sonatype.org/content/repositories/snapshots</a><br>Deploy release artifacts into the staging repository <a href="https://oss.sonatype.org/service/local/staging/deploy/maven2" target="_blank" rel="noopener">https://oss.sonatype.org/service/local/staging/deploy/maven2</a><br>Promote staged artifacts into repository â€˜Releasesâ€™<br>Download snapshot and release artifacts from group <a href="https://oss.sonatype.org/content/groups/public" target="_blank" rel="noopener">https://oss.sonatype.org/content/groups/public</a><br>Download snapshot, release and staged artifacts from staging group <a href="https://oss.sonatype.org/content/groups/staging" target="_blank" rel="noopener">https://oss.sonatype.org/content/groups/staging</a><br>please comment on this ticket when you promoted your first release, thanks</p></blockquote><p>ç„¶åé€šè¿‡ä¸‹é¢çš„æ–¹æ³• Releaseï¼Œå†æ¬¡å›å¤é‚£ä¸ª issueï¼Œå‡ åˆ†é’Ÿååˆæ”¶åˆ°å›å¤:</p><blockquote><p>Central sync is activated for com.linroid. After you successfully release, your component will be published to Central, typically within 10 minutes, though updates to search.maven.org can take up to two hours.</p></blockquote><h2 id="é€šè¿‡-gradle-mvn-push"><a href="#é€šè¿‡-gradle-mvn-push" class="headerlink" title="é€šè¿‡ gradle-mvn-push"></a>é€šè¿‡ gradle-mvn-push</h2><p> <a href="https://chris.banes.me/" target="_blank" rel="noopener">Chris Banes</a>å¤§ç¥å¾ˆæ—©å‰å†™äº†ä¸€ä¸ªæ’ä»¶ <a href="https://github.com/chrisbanes/gradle-mvn-push" target="_blank" rel="noopener">gradle-mvn-push</a>(ç»ˆäºæœ‰æœºä¼šç”¨å®ƒäº†^ï¹^)ï¼Œè®©ä½ é€šè¿‡ä¸€æ¡gradleå‘½ä»¤å°±å¯ä»¥è‡ªåŠ¨æ„å»ºå¥½aarå¹¶æäº¤åˆ° Maven Centralã€‚ä¸‹é¢ä»‹ç»è¿™ä¸ªæ’ä»¶çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><ul><li><p>é…ç½®ç”¨äºä¸Šä¼ çš„<strong>è®¤è¯ä¿¡æ¯</strong><br>é…ç½®æ–‡ä»¶é»˜è®¤åœ¨<code>${HOME}/.gradle/gradle.properties</code>ï¼Œå¦‚æœæ²¡æœ‰åˆ™è‡ªå·±åˆ›å»ºã€‚</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NEXUS_USERNAME=linroid</span><br><span class="line">NEXUS_PASSWORD=YOUR_MAVEN_CENTRAL_PASSWORD</span><br><span class="line"></span><br><span class="line">signing.keyId=YOUR_GPG_KEY_ID</span><br><span class="line">signing.password=YOUR_GPG_PASSWORD</span><br><span class="line">signing.secretKeyRingFile=$&#123;HOME&#125;/.gnupg/secring.gpg</span><br></pre></td></tr></table></figure><p><code>NEXUS_USERNAME</code> å’Œ <code>NEXUS_PASSWORD</code> æ˜¯ä½ æ³¨å†Œçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸‹é¢çš„æ˜¯ç”¨äº GPG æ ¡éªŒçš„é…ç½®ä¿¡æ¯ï¼Œå…³äº GPG çš„ä½¿ç”¨å¯ä»¥å‚è§é˜®ä¸€å³°çš„åšæ–‡:<a href="http://www.ruanyifeng.com/blog/2013/07/gpg.html" target="_blank" rel="noopener">GPG å…¥é—¨æ•™ç¨‹</a></p></li><li><p>é…ç½®<strong>ç‰ˆæœ¬ä¿¡æ¯</strong><br>åœ¨ä½ çš„moduleç›®å½•åˆ›å»º<code>gradle.properties</code>æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®:</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POM_NAME=Android FilterMenu Library</span><br><span class="line">POM_ARTIFACT_ID=library</span><br><span class="line">POM_PACKAGING=aar</span><br><span class="line">VERSION_NAME=0.1.1</span><br><span class="line">VERSION_CODE=1</span><br><span class="line">GROUP=com.linroid.filtermenu</span><br><span class="line"></span><br><span class="line">POM_DESCRIPTION=Android FilterMenu Library</span><br><span class="line">POM_URL=https://github.com/linroid/FilterMenu</span><br><span class="line">POM_SCM_URL=https://github.com/linroid/FilterMenu</span><br><span class="line">POM_SCM_CONNECTION=scm:https://github.com/linroid/FilterMenu.git</span><br><span class="line">POM_SCM_DEV_CONNECTION=scm:https://github.com/linroid/FilterMenu.git</span><br><span class="line">POM_LICENCE_NAME=The Apache Software License, Version 2.0</span><br><span class="line">POM_LICENCE_URL=http://www.apache.org/licenses/LICENSE-2.0.txt</span><br><span class="line">POM_LICENCE_DIST=repo</span><br><span class="line">POM_DEVELOPER_ID=linroid</span><br><span class="line">POM_DEVELOPER_NAME=linroid</span><br><span class="line">POM_DEVELOPER_URL=http://linroid.com</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä½ çš„é¡¹ç›®ä¿®æ”¹å§(â€˜ãƒ»Ï‰ãƒ»â€™)</p></li><li><p><strong>æ·»åŠ gradle-mvn-pushæ’ä»¶</strong><br>åœ¨ library module çš„<code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ </p> <figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">from:</span> <span class="string">'https://raw.github.com/chrisbanes/gradle-mvn-push/master/gradle-mvn-push.gradle</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…å¯ä»¥å°† <a href="https://raw.githubusercontent.com/chrisbanes/gradle-mvn-push/master/gradle-mvn-push.gradle" target="_blank" rel="noopener">gradle-mvn-push.gradle</a> æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå°†ä¸Šé¢çš„urlè¯¥ä¸ºæœ¬åœ°è·¯å¾„ã€‚</p></li><li><p><strong>æ‰§è¡Œgradle task</strong><br>è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œå°±å¯ä»¥è‡ªåŠ¨æ„å»ºå¹¶ä¸Šä¼ å•¦</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gradle clean build uploadArchives</span><br></pre></td></tr></table></figure><p>å‡ºç°å¦‚ä¸‹ç»“æœå°±è¯´æ˜ä¸Šä¼ æˆåŠŸäº†:ï¼‰<br> <img src="http://7u2rtn.com1.z0.glb.clouddn.com/QQ20150313-2@2x.png" alt="æ‰§è¡ŒæˆåŠŸ"><br>è¿˜æ²¡ç»“æŸï¼Œæ­¤æ—¶ä½ çš„åº“å¹¶æ²¡æœ‰å‘å¸ƒ.</p></li><li><p><strong>æœ€åä¸€æ­¥</strong>ï¼šclose staging repositories<br>ç™»é™† <a href="https://oss.sonatype.org/" target="_blank" rel="noopener">Sonatype Nexus Professional</a> ç‚¹å¼€å·¦è¾¹ Build Promotion çš„ Staging Repositories ï¼Œæ»šåˆ°æœ€ä¸‹é¢æ‰¾åˆ°ä½ æœ€æ–°ä¸Šä¼ çš„(å¯ä»¥ç‚¹Contentç¡®ä¿æ˜¯ä½ ä¸Šä¼ çš„)ï¼Œé€‰ä¸­ä¹‹åç‚¹å‡»ä¸Šé¢çš„ <code>Close</code> æŒ‰é’® å’Œ <code>Release</code> æŒ‰é’®(å¤šè°¢<a href="http://weibo.com/drak11t" target="_blank" rel="noopener">@drak11t</a>çš„æç¤º)ã€‚</p><p>Ok äº†ï¼Œè¿˜éœ€è¦ç­‰å¾…ä¸€å°æ®µæ—¶é—´æ‰èƒ½åœ¨ <a href="http://search.maven.org" target="_blank" rel="noopener">http://search.maven.org</a> æœç´¢åˆ°ä½ çš„åŒ…ã€‚</p></li></ul><p>##é“¾æ¥</p><ul><li><a href="http://central.sonatype.org/pages/ossrh-guide.html" target="_blank" rel="noopener">OSSRH Guide</a> å®˜æ–¹æŒ‡å—</li><li><a href="http://www.ruanyifeng.com/blog/2013/07/gpg.html" target="_blank" rel="noopener">GPG å…¥é—¨æ•™ç¨‹</a></li><li><a href="https://github.com/chrisbanes/gradle-mvn-push" target="_blank" rel="noopener">gradle-mvn-push</a> </li><li><a href="https://oss.sonatype.org/" target="_blank" rel="noopener">Sonatype Nexus Professional</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;  å°† &lt;a href=&quot;http://github.com/linroid/FilterMenu&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;FilterMenu&lt;/a&gt; æäº¤åˆ° GitHub åï¼Œåœ¨ README.md çš„ Getting Started é‡Œä»…ä»…å†™ä¸Š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Download the source to use it as library project&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;  è¿™å”¯ä¸€ä½¿ç”¨é€”å¾„ï¼Œå±…ç„¶æ²¡æœ‰ gradle/maven ?ä½œä¸º Android Studio çš„å¿ å®ç”¨æˆ·ï¼Œè‡ªå·±å†™çš„åº“æ€ä¹ˆèƒ½åªæä¾›è¿™ä¹ˆéº»çƒ¦çš„æ–¹æ³•ï¼ï¼ï¼äºæ˜¯å†³å®šæŠŠå®ƒæäº¤åˆ° Maven Central ä¸­ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="gradle" scheme="http://linroid.com/tags/gradle/"/>
    
  </entry>
  
  <entry>
    <title>å››å­£ç”µå°</title>
    <link href="http://linroid.com/2015/02/11/sky31radio/"/>
    <id>http://linroid.com/2015/02/11/sky31radio/</id>
    <published>2015-02-11T05:12:23.000Z</published>
    <updated>2019-12-21T15:56:22.030Z</updated>
    
    <content type="html"><![CDATA[<!-- HTML --><p><blockquote class="blockquote-center"><br>èº²åœ¨æŸä¸€æ—¶é—´ï¼Œæƒ³å¿µä¸€æ®µæ—¶é—´çš„æŒçº¹ï¼›èº²åœ¨æŸä¸€åœ°ç‚¹ï¼Œè†å¬å››å­£çš„å£°éŸ³ã€‚<br><img alt="å››å­£ç”µå°ä¸»æ’­åˆ—è¡¨æˆªå›¾" src="http://7u2rtn.com1.z0.glb.clouddn.com/device-2015-01-22-224820.png" width="300px"><br><a href="http://fir.im/sky31radio" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></blockquote></p><p><br><a id="more"></a><br>å†™å®Œ <a href="http://radio.sky31.com" target="_blank" rel="noopener">http://radio.sky31.com</a> çš„åå°åï¼Œæƒ³æŠŠ app ä¹Ÿå†™å‡ºæ¥.æ­£å¥½äººæœºäº¤äº’å’Œ Java ä¹Ÿè¦äº¤è¯¾ç¨‹è®¾è®¡ï¼Œå°±å¼€å§‹å†™äº†-.-<br>è¿™æ¬¡å·æ‡’ï¼Œæ•°æ®ç¼“å­˜ç›´æ¥ç”¨ DiskLruCache æ¥ç®¡ç†æ²¡æœ‰ä½¿ç”¨æ•°æ®åº“ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨ MVP æ¨¡å¼.<br>æ’­æ”¾å™¨ä½¿ç”¨ SDK ä¸­çš„ <a href="http://developer.android.com/reference/android/media/MediaPlayer.html" target="_blank" rel="noopener">MediaPlayer</a>å®ç°ï¼Œæš‚æ—¶è¿˜æ²¡å®ç°æ’­æ”¾ç¼“å­˜ã€‚<br>ä½¿ç”¨äº†å¦‚ä¸‹çš„å¼€æºåº“ï¼š</p><ul><li><a href="http://jakewharton.github.io/butterknife/" target="_blank" rel="noopener">ButterKnife</a></li><li><a href="http://square.github.io/dagger/" target="_blank" rel="noopener">Dagger</a></li><li><a href="http://square.github.io/retrofit/" target="_blank" rel="noopener">Retrofit</a></li><li><a href="http://square.github.io/okhttp/" target="_blank" rel="noopener">OkHttp</a></li><li><a href="http://code.google.com/p/google-gson/" target="_blank" rel="noopener">Gson</a></li><li><a href="https://github.com/ReactiveX/RxAndroid" target="_blank" rel="noopener">RxAndroid</a></li><li><a href="https://github.com/jgilfelt/SystemBarTint" target="_blank" rel="noopener">SystemBarTint</a></li><li><a href="http://jakewharton.github.io/timber/" target="_blank" rel="noopener">Timber</a></li><li><a href="https://github.com/AnderWeb/discreteSeekBar" target="_blank" rel="noopener">DiscreteSeekBar</a></li></ul><p>æºç æ”¾åœ¨ GitHub ä¸Šäº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹:): <a href="http://github.com/linroid/Sky31Radio" target="_blank" rel="noopener">Githubåœ°å€</a></p>]]></content>
    
    <summary type="html">
    
      &lt;!-- HTML --&gt;
&lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;èº²åœ¨æŸä¸€æ—¶é—´ï¼Œæƒ³å¿µä¸€æ®µæ—¶é—´çš„æŒçº¹ï¼›èº²åœ¨æŸä¸€åœ°ç‚¹ï¼Œè†å¬å››å­£çš„å£°éŸ³ã€‚&lt;br&gt;&lt;img alt=&quot;å››å­£ç”µå°ä¸»æ’­åˆ—è¡¨æˆªå›¾&quot; src=&quot;http://7u2rtn.com1.z0.glb.clouddn.com/device-2015-01-22-224820.png&quot; width=&quot;300px&quot;&gt;&lt;br&gt;&lt;a href=&quot;http://fir.im/sky31radio&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
    
    </summary>
    
      <category term="ä½œå“" scheme="http://linroid.com/categories/%E4%BD%9C%E5%93%81/"/>
    
    
      <category term="å¼€æºé¡¹ç›®" scheme="http://linroid.com/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"/>
    
      <category term="å››å­£ç”µå°" scheme="http://linroid.com/tags/%E5%9B%9B%E5%AD%A3%E7%94%B5%E5%8F%B0/"/>
    
  </entry>
  
  <entry>
    <title>è°ƒç”¨ FragmentPagerAdapter çš„ notifyDataSetChanged() æ–¹æ³•è§†å›¾æœªæ›´æ–°</title>
    <link href="http://linroid.com/2015/01/29/view-not-updated-after-call-FragmentPagerAdapter-notifyDataSetChanged/"/>
    <id>http://linroid.com/2015/01/29/view-not-updated-after-call-FragmentPagerAdapter-notifyDataSetChanged/</id>
    <published>2015-01-29T13:54:39.000Z</published>
    <updated>2019-12-21T15:53:13.853Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦æ ¡åœ¨è€ƒå®Œè¯•åç»™æˆ‘ä»¬åŠ äº†ä¸€å‘¨çš„ Android è¯¾ï¼Œæœ¬æ¥è€ƒå®Œè¯•å¾ˆç´¯äº†ï¼Œè¿˜ä¸€å¤©ä¸è®©ä¼‘æ¯ï¼Œå¤©å¤©èµ·æ—©å»ä¸Šè¯¾Ï€__Ï€ã€‚æœ€åäº¤è¯¾ç¨‹è®¾è®¡, æ¨¡ä»¿å½©è™¹å¤©æ°”å†™ä¸€ä¸ªå¤©æ°”åº”ç”¨,ä¸‹é¢æ˜¯æˆ‘ä»¬ç»„åšçš„:<br><img src="https://cdn.linroid.com/media/view-not-updated-after-call-FragmentPagerAdapter-notifyDataSetChanged/device-2015-01-26-105356.png" width="300px"><br><a id="more"></a><br>åŸå¸‚åˆ‡æ¢ä½¿ç”¨çš„ ViewPagerï¼Œä»¥ä¸‹æ˜¯ FragmentPagerAdapter é‡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå½“ Loader åŠ è½½äº†æ–°çš„ Cursor åè°ƒç”¨è¯¥æ–¹æ³•ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCursor</span><span class="params">(Cursor cursor)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count = cursor==<span class="keyword">null</span> ? <span class="number">0</span> : cursor.getCount();</span><br><span class="line">    Timber.d(<span class="string">"cursor count : %d"</span>, count);</span><br><span class="line">    weathers.clear();</span><br><span class="line">    <span class="keyword">if</span>(count==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;count; i++)&#123;</span><br><span class="line">        cursor.moveToPosition(i);</span><br><span class="line">        Weather weather = Weather.fromCursor(cursor);</span><br><span class="line">        weathers.add(weather);</span><br><span class="line">    &#125;</span><br><span class="line">    notifyDataSetChanged();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æƒ³å½“ç„¶åœ°åƒä½¿ç”¨ ListView çš„é€‚é…å™¨ä¸€æ ·è°ƒç”¨ <code>notifyDataSetChanged()</code>,ç”¨ä½†å½“æ·»åŠ åˆ é™¤åŸå¸‚å ViewPager é‡Œçš„è§†å›¾å¹¶æ²¡æœ‰å¾—åˆ°æ›´æ–°ã€‚Google äº†ä¸‹ï¼ŒStackoverflow é‡Œçš„ä¸€ä¸ªå›ç­”è®©é‡å†™ getItemPosition() æ–¹æ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemPosition</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> POSITION_NONE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ äº†ä¹‹åï¼ŒFragment çš„æ•°ç›®çš„ç¡®å¢åŠ /åˆ é™¤äº†ï¼Œä½† Fragment é‡Œçš„å†…å®¹å¹¶æ²¡æœ‰æ›´æ–°ï¼Œä¼šå‡ºç°ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„åŸå¸‚(å› ä¸ºæˆ‘è®¾ç½®æ–°å¢çš„åŸå¸‚æ˜¾ç¤ºåœ¨å‰é¢,ä¸ç„¶å°±ä¸ä¼šé‡å¤äº†)ã€‚<br>æƒ³äº†ä¸€ä¸‹ï¼Œæ—¢ç„¶æ˜¯ fragment åº”è¯¥ä¸ä¼šä¸ä¼šåƒæ™®é€šè§†å›¾ä¸€æ ·åœ¨æ•°æ®æ›´æ–°åç›´æ¥é”€æ¯æ‰ï¼Œäºæ˜¯æŸ¥çœ‹äº† FragmentPagerAdapter çš„æºç ã€‚PagerAdapter é€šè¿‡ <code>instantiateItem(ViewGroup container, int position)</code> æ¥è·å¾—ä¸€ä¸ªè§†å›¾, FragmentPagerAdapter ä¸­çš„å®ç°å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">instantiateItem</span><span class="params">(ViewGroup container, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mCurTransaction == <span class="keyword">null</span>) &#123;</span><br><span class="line">        mCurTransaction = mFragmentManager.beginTransaction();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">long</span> itemId = getItemId(position);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do we already have this fragment?</span></span><br><span class="line">    String name = makeFragmentName(container.getId(), itemId);</span><br><span class="line">    Fragment fragment = mFragmentManager.findFragmentByTag(name);</span><br><span class="line">    <span class="keyword">if</span> (fragment != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (DEBUG) Log.v(TAG, <span class="string">"Attaching item #"</span> + itemId + <span class="string">": f="</span> + fragment);</span><br><span class="line">        mCurTransaction.attach(fragment);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fragment = getItem(position);</span><br><span class="line">        <span class="keyword">if</span> (DEBUG) Log.v(TAG, <span class="string">"Adding item #"</span> + itemId + <span class="string">": f="</span> + fragment);</span><br><span class="line">        mCurTransaction.add(container.getId(), fragment,</span><br><span class="line">                makeFragmentName(container.getId(), itemId));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fragment != mCurrentPrimaryItem) &#123;</span><br><span class="line">        fragment.setMenuVisibility(<span class="keyword">false</span>);</span><br><span class="line">        fragment.setUserVisibleHint(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fragment;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸­å¯ä»¥çœ‹å‡ºå½“åœ¨å®ä¾‹åŒ– position ä½ç½®çš„ fragment æ—¶ï¼Œé¦–å…ˆä» FragmentManager æŸ¥æ‰¾åœ¨è¯¥ position ä½ç½®æ˜¯å¦å·²ç»åˆ›å»ºäº† fragmentï¼Œå¦‚æœå­˜åœ¨ç›´æ¥ä½¿ç”¨è¿™ä¸ª fragmentï¼Œä»è€Œè¾¾åˆ°å¤ç”¨.<br>å‡å¦‚ç°åœ¨æœ‰äº†ä¸‰ä¸ªåŸå¸‚Aã€Bã€Cï¼Œposition åˆ†åˆ«ä¸º0ã€1ã€2.ç„¶åæ·»åŠ äº†ä¸€ä¸ªåŸå¸‚ Zï¼ŒZ çš„ positionä¸º 0ï¼ŒC ä¸º 3ã€‚FragmentManager é‡Œå·²ç»å­˜åœ¨äº† position ä¸º0,1,2çš„ fragmentï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªè§†å›¾æ²¡æœ‰æ”¹å˜ï¼Œä½†ç°åœ¨éœ€è¦çš„ fragment çš„æ•°ç›®å˜äº†ï¼Œå¢åŠ 1ã€‚ä¼šåˆ›å»º position ä¸º3çš„ fragmentï¼Œè€Œæ­¤æ—¶æ˜¯åŸå¸‚Cï¼Œæ‰€ä»¥è¿™æ ·å°±ä¼šå¯¼è‡´æ˜¾ç¤ºä¸¤æ¬¡Cï¼Œè€Œæ–°å¢çš„ZåŸå¸‚æ²¡æœ‰æ˜¾ç¤ºã€‚<br>æƒ³èµ·ä¹‹å‰å†™ FragmentPagerAdapter è¿˜ä¼šæ‰‹åŠ¨åœ¨ getItem() æ–¹æ³•é‡Œåˆ¤æ–­ Fragment æ˜¯å¦å·²ç»åˆ›å»ºï¼Œå®Œå…¨æ²¡å¿…è¦å˜›, FragmentPagerAdapter å·²ç»ä¸ºæˆ‘ä»¬åšäº†è¿™ç‚¹-.-<br>è§£å†³çš„åŠæ³•:<br>åœ¨é€šçŸ¥æ•°æ®æ›´æ–°ä¹‹å‰ä» FragmentManager é‡Œç§»é™¤æ‰€æœ‰ Fragmentï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">removeALlFragments</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FragmentTransaction transaction = fm.beginTransaction();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;fragments.size(); i++)&#123;</span><br><span class="line">        Fragment fg = fragments.get(i);</span><br><span class="line">        transaction.remove(fg);</span><br><span class="line">    &#125;</span><br><span class="line">    transaction.commit();</span><br><span class="line">    fragments.clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æœ‰äº›æš´åŠ›äº†ï¼Œæ¯•ç«Ÿåˆ›å»ºä¸€ä¸ª fragment éœ€è¦æ¶ˆè€—è¾ƒå¤§çš„èµ„æº.å†³å®šé‡å†™ instantiateItem() æ–¹æ³•,å½“æ•°æ®æ›´æ–°æ—¶ï¼Œå¤ç”¨å·²æœ‰çš„ fragmentï¼Œæ›´æ–°é‡Œé¢çš„æ•°æ®ã€‚</p><ul><li><p>é‡å†™ <code>instantiateItem()</code> æ–¹æ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">instantiateItem</span><span class="params">(ViewGroup container, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">    WeatherFragment fragment = (WeatherFragment) <span class="keyword">super</span>.instantiateItem(container, position);</span><br><span class="line">    Weather weather = weathers.get(position);</span><br><span class="line">    fragment.setWeatherData(weather);</span><br><span class="line">    <span class="keyword">return</span> fragment;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ WeatherFragment é‡Œæ·»åŠ ä¸‹é¢çš„æ–¹æ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWeatherData</span><span class="params">(<span class="keyword">final</span> Weather weather)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.weather = weather;</span><br><span class="line">    <span class="keyword">if</span>(rootView==<span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å­¦æ ¡åœ¨è€ƒå®Œè¯•åç»™æˆ‘ä»¬åŠ äº†ä¸€å‘¨çš„ Android è¯¾ï¼Œæœ¬æ¥è€ƒå®Œè¯•å¾ˆç´¯äº†ï¼Œè¿˜ä¸€å¤©ä¸è®©ä¼‘æ¯ï¼Œå¤©å¤©èµ·æ—©å»ä¸Šè¯¾Ï€__Ï€ã€‚æœ€åäº¤è¯¾ç¨‹è®¾è®¡, æ¨¡ä»¿å½©è™¹å¤©æ°”å†™ä¸€ä¸ªå¤©æ°”åº”ç”¨,ä¸‹é¢æ˜¯æˆ‘ä»¬ç»„åšçš„:&lt;br&gt;&lt;img src=&quot;https://cdn.linroid.com/media/view-not-updated-after-call-FragmentPagerAdapter-notifyDataSetChanged/device-2015-01-26-105356.png&quot; width=&quot;300px&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="é‡è¿‡çš„å‘" scheme="http://linroid.com/categories/%E9%81%87%E8%BF%87%E7%9A%84%E5%9D%91/"/>
    
    
      <category term="Fragment" scheme="http://linroid.com/tags/Fragment/"/>
    
  </entry>
  
  <entry>
    <title>Archlinux ä¸‹ç¼–è¯‘ AOSP å°è®°</title>
    <link href="http://linroid.com/2015/01/27/compile-aosp-on-archlinux/"/>
    <id>http://linroid.com/2015/01/27/compile-aosp-on-archlinux/</id>
    <published>2015-01-27T01:51:28.000Z</published>
    <updated>2019-12-21T15:53:13.851Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ç”¨çš„æ˜¯ fish shellï¼Œé¦–å…ˆè¦è¿›å…¥åˆ° bash shell:<br>    <code>bash</code><br>åˆ‡æ¢jdkç‰ˆæœ¬åˆ°1.7<br>    <code>sudo archlinux-java set java-7-openjdk</code><br>åˆ‡æ¢pythonç‰ˆæœ¬åˆ°2.x<br>    <code>sudo ln -sf /usr/bin/python2.7  /usr/bin/python</code><br>å®‰è£…ä¾èµ–åº“<br>    <code>yaourt -S libtinfo</code><br><a id="more"></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ç”¨çš„æ˜¯ fish shellï¼Œé¦–å…ˆè¦è¿›å…¥åˆ° bash shell:&lt;br&gt;    &lt;code&gt;bash&lt;/code&gt;&lt;br&gt;åˆ‡æ¢jdkç‰ˆæœ¬åˆ°1.7&lt;br&gt;    &lt;code&gt;sudo archlinux-java set java-7-openjdk&lt;/code&gt;&lt;br&gt;åˆ‡æ¢pythonç‰ˆæœ¬åˆ°2.x&lt;br&gt;    &lt;code&gt;sudo ln -sf /usr/bin/python2.7  /usr/bin/python&lt;/code&gt;&lt;br&gt;å®‰è£…ä¾èµ–åº“&lt;br&gt;    &lt;code&gt;yaourt -S libtinfo&lt;/code&gt;&lt;br&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="linux" scheme="http://linroid.com/tags/linux/"/>
    
      <category term="AOSP" scheme="http://linroid.com/tags/AOSP/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨ GitHub çš„ Webhook éƒ¨ç½²åšå®¢</title>
    <link href="http://linroid.com/2015/01/21/using-github-webhook-to-deploy-my-blog/"/>
    <id>http://linroid.com/2015/01/21/using-github-webhook-to-deploy-my-blog/</id>
    <published>2015-01-20T16:01:28.000Z</published>
    <updated>2019-12-21T15:53:13.853Z</updated>
    
    <content type="html"><![CDATA[<p>GitHub ç°åœ¨æ¯”è¾ƒéš¾æ‰“å¼€äº†ï¼Œå†³å®šæŠŠåšå®¢æ”¾åˆ°è‡ªå·±çš„ vps ä¸Šã€‚<br>å½“åˆæƒ³åŒæ­¥åˆ° GitHub ä¸Šï¼Œå¦‚æœæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨åˆ° vps ä¸Šæ‰§è¡Œ pullï¼Œé‚£å¤ªéº»çƒ¦äº†ï¼ï¼ï¼<br>GitHub çš„ä»“åº“å¯ä»¥è®¾ç½® <code>Webhook</code>ï¼Œå½“æ”¶åˆ° push åä¼šé€šçŸ¥åˆ°è®¾å®šçš„ urlï¼Œæ•‘æ˜Ÿæ¥å•¦ï½ï½ï½<br><a id="more"></a><br>çœ‹äº†ä¸‹ api æ–‡æ¡£ï¼Œç”¨ php å†™äº† <code>git-hook.php</code> æ–‡ä»¶æ”¾åˆ°åšå®¢ç›®å½•ä¸‹:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">7</span>);</span><br><span class="line">date_default_timezone_set(<span class="string">'UTC'</span>);</span><br><span class="line">define(<span class="string">"WWW_ROOT"</span>, <span class="string">"/www/linroid.com/"</span>);</span><br><span class="line">define(<span class="string">"LOG_FILE"</span>, <span class="string">"/www/logs/linroid.com/git-hook.log"</span>);</span><br><span class="line">$shell = sprintf(<span class="string">"cd %s &amp;&amp; /usr/bin/git pull 2&gt;&amp;1"</span>, WWW_ROOT);</span><br><span class="line">$output = shell_exec($shell);</span><br><span class="line">$log = sprintf(<span class="string">"[%s] %s \n"</span>, date(<span class="string">'Y-m-d H:i:s'</span>, time()), $output);</span><br><span class="line"><span class="keyword">echo</span> $log;</span><br><span class="line">file_put_contents(LOG_FILE, $log, FILE_APPEND);</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ ssh æ‰§è¡Œ <code>php git-hook.php</code> æˆåŠŸï¼Œä½† url è®¿é—®æ—¶å¤±è´¥äº†ã€‚vps ä¸Šæ˜¯é€šè¿‡ php-fpm æ‰§è¡Œ php çš„ï¼Œç”¨æˆ·ä¸º <code>www-data</code>ï¼Œshell ä¸º<code>/usr/sbin/nologin</code>,ä¼šæ‰¾ä¸åˆ° git å‘½ä»¤,éœ€è¦ä½¿ç”¨ git çš„ç»å¯¹è·¯å¾„:<br><code>$shell = sprintf(&quot;cd %s &amp;&amp; /usr/bin/git pull&quot;, WWW_ROOT);</code></p><p>å‡ºç°æƒé™é—®é¢˜<br><code>error: cannot open .git/FETCH_HEAD: Permission denied</code></p><p>ä¿®æ”¹ç›®å½•æ‰€å±ï¼š<br><code>sudo chown  -R www-data:www-data ./linroid.com</code></p><p>åœ¨ä»“åº“çš„webhooké‡Œæ·»åŠ url <code>http://linroid.com/git-hook.php</code>,ç„¶å vps å°±å¯ä»¥ä» GitHub è‡ªåŠ¨ pull äº†~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;GitHub ç°åœ¨æ¯”è¾ƒéš¾æ‰“å¼€äº†ï¼Œå†³å®šæŠŠåšå®¢æ”¾åˆ°è‡ªå·±çš„ vps ä¸Šã€‚&lt;br&gt;å½“åˆæƒ³åŒæ­¥åˆ° GitHub ä¸Šï¼Œå¦‚æœæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨åˆ° vps ä¸Šæ‰§è¡Œ pullï¼Œé‚£å¤ªéº»çƒ¦äº†ï¼ï¼ï¼&lt;br&gt;GitHub çš„ä»“åº“å¯ä»¥è®¾ç½® &lt;code&gt;Webhook&lt;/code&gt;ï¼Œå½“æ”¶åˆ° push åä¼šé€šçŸ¥åˆ°è®¾å®šçš„ urlï¼Œæ•‘æ˜Ÿæ¥å•¦ï½ï½ï½&lt;br&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="Blog" scheme="http://linroid.com/tags/Blog/"/>
    
      <category term="Github" scheme="http://linroid.com/tags/Github/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ NameCheap çš„ SSL è¯ä¹¦</title>
    <link href="http://linroid.com/2014/12/21/setting-up-ssl-with-nginx-using-a-namecheap-essentialssl/"/>
    <id>http://linroid.com/2014/12/21/setting-up-ssl-with-nginx-using-a-namecheap-essentialssl/</id>
    <published>2014-12-20T17:14:35.000Z</published>
    <updated>2019-12-21T15:53:13.852Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/media/setting-up-ssl-with-nginx-using-a-namecheap-essentialssl/20141221121928.png" alt="ä½¿ç”¨NameCheapçš„SSLè¯ä¹¦"><br>åˆ©ç”¨ä¹‹å‰ç”³è¯·äº† GitHub çš„å­¦ç”Ÿç¤¼åŒ…å…è´¹æ³¨å†Œäº† [alwen.me] åŸŸåï¼Œå¦å¤–ä¸€å¹´å…è´¹çš„ ssl è¯ä¹¦ä¹Ÿç”³è¯·äº†.<br><a id="more"></a><br>åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆç”¨äºç”³è¯·è¯ä¹¦çš„ CSR å’Œç§é’¥<br><code>openssl req -new -nodes -keyout alwen_me.key -out alwen_me.csr</code><br>å°† csr äº¤åˆ° NameCheapï¼Œæ•°å°æ—¶å <a href="mailto:webmaster@alwen.me" target="_blank" rel="noopener">webmaster@alwen.me</a> æ”¶åˆ°äº†æ¥è‡ª Comodo çš„åŸŸåæ§åˆ¶æƒéªŒè¯é‚®ä»¶ï¼Œå®ŒæˆéªŒè¯åï¼Œç®¡ç†å‘˜é‚®ç®±å°±ä¼šæ”¶åˆ° PositiveSSL è¯ä¹¦äº†<br>é™„ä»¶ä¸­ä¸€å…±åŒ…å«å››ä¸ªæ–‡ä»¶ï¼š</p><ul><li>Root CA Certificate - AddTrustExternalCARoot.crt</li><li>Intermediate CA Certificate - COMODORSAAddTrustCA.crt</li><li>Intermediate CA Certificate - COMODORSADomainValidationSecureServerCA.crt</li><li>Your PositiveSSL Certificate - alwen_me.crt</li></ul><p>éœ€è¦å°†è¿™å‡ ä¸ªå¯†é’¥æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat alwen_me.crt COMODORSADomainValidationSecureServerCA.crt COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt &gt; ssl_bundle.cer</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥å°±æ˜¯è®¾ç½® nginx é…ç½®æ–‡ä»¶å¼€å¯ ssl äº†:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># HTTPS server</span><br><span class="line">server &#123;</span><br><span class="line">listen 443;</span><br><span class="line">server_name alwen.me;</span><br><span class="line"></span><br><span class="line">root /www/alwen/;</span><br><span class="line">index index.html index.htm;</span><br><span class="line"></span><br><span class="line">ssl on;</span><br><span class="line">ssl_certificate ssl/ssl_bundle.crt;</span><br><span class="line">ssl_certificate_key ssl/alwen_me.key;</span><br><span class="line"></span><br><span class="line">ssl_session_timeout 5m;</span><br><span class="line"></span><br><span class="line">ssl_protocols SSLv3 TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">ssl_ciphers &quot;HIGH:!aNULL:!MD5 or HIGH:!aNULL:!MD5:!3DES&quot;;</span><br><span class="line">ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">try_files $uri $uri/ =404;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¹¶ä¸”å°† http è®¿é—®è·³è½¬è‡³ https è¿æ¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name alwen.me www.alwen.me;</span><br><span class="line">  return 301 https://alwen.me$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¤§åŠŸå‘Šæˆ(&gt;â–½&lt;)ï¼Œç°åœ¨è®¿é—® <a href="https://alwen.me" target="_blank" rel="noopener">alwen.me</a> æµè§ˆå™¨å°±æ˜¾ç¤ºå‡ºå®‰å…¨æ ‡å¿—äº†.<br>å¿…é¡»æ„Ÿè°¢ GitHub æä¾›çš„ <a href="https://education.github.com/pack" target="_blank" rel="noopener">å­¦ç”Ÿç¤¼åŒ…</a> å•Šï¼Œè¿˜æœ‰100ç¾åˆ€çš„ DigitalOcean æ¶ˆè´¹åŠµç”¨æ¥ä½œæ¢¯å­å†å¥½ä¸è¿‡å•¦ï½ä¸è¿‡ç°åœ¨å¥½åƒå›½å†…çš„ .edu é‚®ç®±è¢«å±è”½ï¼Œç”³è¯·ä¸äº†äº† &gt;ï¹&lt;</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/media/setting-up-ssl-with-nginx-using-a-namecheap-essentialssl/20141221121928.png&quot; alt=&quot;ä½¿ç”¨NameCheapçš„SSLè¯ä¹¦&quot;&gt;&lt;br&gt;åˆ©ç”¨ä¹‹å‰ç”³è¯·äº† GitHub çš„å­¦ç”Ÿç¤¼åŒ…å…è´¹æ³¨å†Œäº† [alwen.me] åŸŸåï¼Œå¦å¤–ä¸€å¹´å…è´¹çš„ ssl è¯ä¹¦ä¹Ÿç”³è¯·äº†.&lt;br&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="Blog" scheme="http://linroid.com/tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>å¤§åŠå¹´æ²¡å†™åšå®¢äº†T_T</title>
    <link href="http://linroid.com/2014/12/21/no-writing-so-long/"/>
    <id>http://linroid.com/2014/12/21/no-writing-so-long/</id>
    <published>2014-12-20T16:50:33.000Z</published>
    <updated>2019-12-21T15:53:13.852Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ç”¨ Octopress åœ¨ GitHub ä¸Šå†™äº†å‡ ç¯‡ï¼Œé‡è£…ç³»ç»Ÿåé…ç½®å‡ºç°äº†é—®é¢˜ï¼Œå°±å¾ˆä¹…æ‡’å¾—åŠ¨å®ƒäº†ã€‚ä¹‹åç”¨äº† hexo é‡æ–°æ­å»ºåä¸€ç›´æç½®ç€ä¹Ÿæ²¡åŠ¨(Octopress çš„åšæ–‡å¯ä»¥ç›´æ¥è¿ç§»åˆ° Hexoï¼Œèµï¼)ã€‚<br>è¿˜æ˜¯è¦å†™å†™ï¼Œé‚£æˆ‘å°±éšä¾¿å†™å§ãƒ¾(â—Â´â–½ï½€â—)ãƒ<br><a id="more"></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ç”¨ Octopress åœ¨ GitHub ä¸Šå†™äº†å‡ ç¯‡ï¼Œé‡è£…ç³»ç»Ÿåé…ç½®å‡ºç°äº†é—®é¢˜ï¼Œå°±å¾ˆä¹…æ‡’å¾—åŠ¨å®ƒäº†ã€‚ä¹‹åç”¨äº† hexo é‡æ–°æ­å»ºåä¸€ç›´æç½®ç€ä¹Ÿæ²¡åŠ¨(Octopress çš„åšæ–‡å¯ä»¥ç›´æ¥è¿ç§»åˆ° Hexoï¼Œèµï¼)ã€‚&lt;br&gt;è¿˜æ˜¯è¦å†™å†™ï¼Œé‚£æˆ‘å°±éšä¾¿å†™å§ãƒ¾(â—Â´â–½ï½€â—)ãƒ&lt;br&gt;
    
    </summary>
    
      <category term="éšç¬”" scheme="http://linroid.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="Blog" scheme="http://linroid.com/tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>Google å‘å¸ƒçš„å®˜æ–¹åˆ·æ–°ç»„ä»¶ï¼šSwipeRefreshLayout</title>
    <link href="http://linroid.com/2014/04/08/2014-04-08-google_offical_refresh_widget/"/>
    <id>http://linroid.com/2014/04/08/2014-04-08-google_offical_refresh_widget/</id>
    <published>2014-04-08T10:12:00.000Z</published>
    <updated>2019-12-21T15:53:13.848Z</updated>
    
    <content type="html"><![CDATA[<p>è°·æ­Œç»ˆäºå‘å¸ƒäº†å®˜æ–¹çš„ä¸‹æ‹‰åˆ·æ–°ç»„ä»¶ï¼š<a href="http://developer.android.com/reference/android/support/v4/widget/SwipeRefreshLayout.html" target="_blank" rel="noopener">SwipeRefreshLayout</a>ï¼Œå®ƒè¢«åŒ…å«åœ¨äº†19.1.0ç‰ˆæœ¬çš„Support Libraryä¸­ã€‚<code>SwipeRefreshLayout</code>åœ¨ä½¿ç”¨ä¸Šéå¸¸ç®€å•,åªéœ€è¦æŠŠè¦åˆ·æ–°çš„å¯æ»šåŠ¨ç»„ä»¶æ”¾åˆ°<code>SwipeRefreshLayout</code> ä¸­,<br><a id="more"></a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag">Â Â Â Â <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â <span class="attr">android:id</span>=<span class="string">"@+id/swipe_container"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">Â </span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">ScrollView</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">Â </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">android:text</span>=<span class="string">"@string/hello_world"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">android:layout_marginTop</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">android:gravity</span>=<span class="string">"center"</span>/&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br><span class="line">Â </span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.SwipeRefreshLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åè°ƒç”¨<code>setOnRefreshListener(OnRefreshListener listener)</code> å’Œ <code>setColorScheme(int colorRes1, int colorRes2, int colorRes3, int colorRes4)</code>ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œè®¾ç½®ï¼Œåœ¨OnRefreshListenerä¸­å®ç°<code>onRefresh()</code>æ–¹æ³•å³å¯:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line"> </span><br><span class="line">    swipeLayout = (SwipeRefreshLayout) findViewById(R.id.swipe_container);</span><br><span class="line">    swipeLayout.setOnRefreshListener(<span class="keyword">this</span>);</span><br><span class="line">    swipeLayout.setColorScheme(android.R.color.holo_blue_bright, </span><br><span class="line">            android.R.color.holo_green_light, </span><br><span class="line">            android.R.color.holo_orange_light, </span><br><span class="line">            android.R.color.holo_red_light);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> Handler().postDelayed(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            swipeLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>SwipeRefreshLayout</code>å®ç°äº†Google Nowä¸­åˆ·æ–°çš„é£æ ¼ï¼Œä¸ä¹‹ç±»ä¼¼çš„æœ‰ä¸€ä¸ªå¼€æºåº“<a href="https://github.com/chrisbanes/ActionBar-PullToRefresh" target="_blank" rel="noopener">ActionBar-PullToRefresh</a>åˆ™å®ç°äº†Google Plusçš„é£æ ¼ã€‚<br><img src="/media/2014-04-08-google_offical_refresh_widget/google_now_refresh_style.png" alt="google_now_refresh_style"><br>Google Nowå³æ—¶å¡è´´ä¸­çš„åˆ·æ–°<br><img src="/media/2014-04-08-google_offical_refresh_widget/google_plus_refresh_style.png" alt="google_plus_refresh_style"><br>Google Plusä¸­çš„åˆ·æ–°<br>è™½ç„¶<code>ActionBar-PullToRefresh</code>çš„å¼€å‘è€…åœ¨å‰ä¸ä¹…å»ºè®®å¤§å®¶ä½¿ç”¨<code>SwipeRefreshLayout</code>ä½†æ˜¯æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…è¿˜æ˜¯æœ‰ä¸€å®šçš„åŒºåˆ«ï¼ŒSwipeRefreshLayoutå¹¶ä¸èƒ½å®Œå…¨å–ä»£</p><ul><li>ä½ç½®ä¸åŒï¼šActionBar-PullToRefreshçš„åˆ·æ–°è¿›åº¦æ¡å§‹ç»ˆåœ¨ActionBaråº•éƒ¨ï¼ŒSwipeRefreshLayoutçš„è¿›åº¦æ¡åœ¨è¦åˆ·æ–°ç»„ä»¶çš„é¡¶éƒ¨ã€‚</li><li>ActionBar-PullToRefreshåœ¨ä¸‹æ‹‰çš„æ—¶å€™ActionBarä¼šè®¾ç½®ç›¸åº”çš„æ–‡å­—æŒ‡ç¤ºï¼Œè€ŒSwipeRefreshLayoutåˆ™åªæ˜¯æŠŠè¢«æ»šåŠ¨çš„ç»„ä»¶éšç€æ‰‹æŒ‡çš„ç§»åŠ¨å‘ä¸‹æ»‘åŠ¨ã€‚<br>SwipeRefreshLayoutä¼šå¼ºåˆ¶å¡«å……æ•´ä¸ªçˆ¶å®¹å™¨ï¼Œå¯¹å…¶è®¾ç½®<code>layout_height</code> å’Œ <code>layout_width</code>æ— æ•ˆï¼Œå¦‚æœè¦åœ¨å½“å‰å¸ƒå±€ä¸­æ˜¾ç¤ºå…¶ä»–éè¦è¢«åˆ·æ–°çš„ç»„ä»¶ï¼Œåˆ™éœ€è¦ç»™SwipeRefreshLayoutå¤–å¥—ä¸€ä¸ªçˆ¶å®¹å™¨:<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;RelativeLayout</span><br><span class="line">    xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    xmlns:tools=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">    android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">    android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">    tools:context=<span class="string">"com.xtuers.android.ui.question.DetailActivity"</span>&gt;</span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:layout_alignParentTop=<span class="string">"true"</span></span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">        android:layout_above=<span class="string">"@+id/answer_bottom_container"</span></span><br><span class="line">        &gt;</span><br><span class="line">        &lt;android.support.v4.widget.SwipeRefreshLayout</span><br><span class="line">            android:id=<span class="string">"@id/swipe_refresh_container"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line">            &lt;ListView</span><br><span class="line">                android:id=<span class="string">"@+id/answer_list"</span></span><br><span class="line">                android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">                android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">                android:divider=<span class="string">"@android:color/transparent"</span>/&gt;</span><br><span class="line">        &lt;/android.support.v4.widget.SwipeRefreshLayout&gt;</span><br><span class="line">    &lt;/FrameLayout&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è°·æ­Œç»ˆäºå‘å¸ƒäº†å®˜æ–¹çš„ä¸‹æ‹‰åˆ·æ–°ç»„ä»¶ï¼š&lt;a href=&quot;http://developer.android.com/reference/android/support/v4/widget/SwipeRefreshLayout.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SwipeRefreshLayout&lt;/a&gt;ï¼Œå®ƒè¢«åŒ…å«åœ¨äº†19.1.0ç‰ˆæœ¬çš„Support Libraryä¸­ã€‚&lt;code&gt;SwipeRefreshLayout&lt;/code&gt;åœ¨ä½¿ç”¨ä¸Šéå¸¸ç®€å•,åªéœ€è¦æŠŠè¦åˆ·æ–°çš„å¯æ»šåŠ¨ç»„ä»¶æ”¾åˆ°&lt;code&gt;SwipeRefreshLayout&lt;/code&gt; ä¸­,&lt;br&gt;
    
    </summary>
    
      <category term="çæŠ˜è…¾" scheme="http://linroid.com/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
      <category term="Android" scheme="http://linroid.com/tags/Android/"/>
    
      <category term="SwipeRefreshLayout" scheme="http://linroid.com/tags/SwipeRefreshLayout/"/>
    
  </entry>
  
</feed>
